
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3.3. Pandas &#8212; Python para Estatísticos</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://tmfilho.github.io/pyestbook/math/04_pand.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.4. Matplotlib" href="05_matp.html" />
    <link rel="prev" title="3.2. SciPy" href="03_scip.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://tmfilho.github.io/pyestbook/math/04_pand.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Pandas" />
<meta property="og:description" content="Pandas  O pacote pandas é uma das ferramentas de Python mais importantes para cientistas e analistas de dados atualmente. Ele é a base da maior parte dos projet" />
<meta property="og:image"       content="https://tmfilho.github.io/pyestbook/_static/logo-arte.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo-arte.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python para Estatísticos</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Python para Estatísticos
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../guide/01_first.html">
   1. Conceitos Fundamentais
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/02_ides.html">
     1.1. Ambientes de Trabalho
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/03_var.html">
     1.2. Variáveis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/04_oper.html">
     1.3. Operadores
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/05_cole.html">
     1.4. Coleções
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/06_cond.html">
     1.5. Condições e Laços
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/07_func.html">
     1.6. Funções
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/08_modu.html">
     1.7. Módulos e Importação
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guide/09_exer.html">
     1.8. Exercícios
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../objects/01_first.html">
   2. Objetos e Classes
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../objects/02_cpyt.html">
     2.1.1. Classes em Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../objects/03_inhe.html">
     2.1.2. Herança e Polimorfismo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../objects/04_erro.html">
     2.1.3. Erros e Exceções
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../objects/05_exer.html">
     2.1.4. Exercícios
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="01_first.html">
   3. Computação Matemática e Científica
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="02_nump.html">
     3.1. NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_scip.html">
     3.2. SciPy
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3.3. Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05_matp.html">
     3.4. Matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_exer.html">
     3.5. Exercícios
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../solutions/intro.html">
   4. Soluções dos Exercícios
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/guide.html">
     4.1. Conceitos Fundamentais
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/objects.html">
     4.2. Objetos e Classes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   5. Referências
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/math/04_pand.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/tmfilho/pyestbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/tmfilho/pyestbook/issues/new?title=Issue%20on%20page%20%2Fmath/04_pand.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/tmfilho/pyestbook/master?urlpath=tree/math/04_pand.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/tmfilho/pyestbook/blob/master/math/04_pand.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#acessando-os-dados">
   3.3.1. Acessando os dados
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estatistica-descritiva">
   3.3.2. Estatística descritiva
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ordenando-valores">
   3.3.3. Ordenando valores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combinando-series-e-dataframes">
   3.3.4. Combinando
   <em>
    Series
   </em>
   e
   <em>
    DataFrames
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iterando-sobre-objetos">
   3.3.5. Iterando sobre objetos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dividindo-um-objeto-em-grupos">
   3.3.6. Dividindo um objeto em grupos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lendo-e-escrevendo-dados">
   3.3.7. Lendo e escrevendo dados
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tabelas-pivotadas">
   3.3.8. Tabelas pivotadas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reindexando-e-alterando-rotulos">
   3.3.9. Reindexando e alterando rótulos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preenchendo-valores-faltantes">
     3.3.9.1. Preenchendo valores faltantes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removendo-rotulos">
   3.3.10. Removendo rótulos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#renomeando-rotulos">
   3.3.11. Renomeando rótulos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#substituindo-valores">
   3.3.12. Substituindo valores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aplicando-funcoes">
   3.3.13. Aplicando funções
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pandas">
<h1><span class="section-number">3.3. </span>Pandas<a class="headerlink" href="#pandas" title="Permalink to this headline">¶</a></h1>
<p>O pacote <em>pandas</em> é uma das ferramentas de <em>Python</em> mais importantes para cientistas e analistas de dados atualmente. Ele é a base da maior parte dos projetos que incluem leitura, manipulação, limpeza e escrita de dados. O nome <em>pandas</em> é derivado do termo <em>panel data</em> (dados em painel), que é um termo econométrico que descreve dados compostos de múltiplas observações através do tempo para os mesmos indivíduos.</p>
<p><em>Pandas</em> foi desenvolvido como uma camada acima do <em>NumPy</em>, mas boa parte de suas funcionalidades de análise estatística são feitas pelo <em>SciPy</em>, além do uso do <em>Matplotlib</em> para funções de visualização. Dessa forma, <em>pandas</em> simplifica o uso de diversas bibliotecas úteis para estatísticos e cientistas de dados.</p>
<p>Os dois principais objetos de <em>pandas</em> são as séries (<em>Series</em>) e as tabelas (<em>DataFrame</em>). Uma <em>Series</em> é basicamente uma coluna, enquanto uma <em>DataFrame</em> é uma tabela multidimensional composta de uma coleção de Series. Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>

<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.0
1    3.0
2    5.0
3    NaN
4    6.0
5    8.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>A Series acima foi criada por meio de uma lista de valores, incluindo o valor <em>NaN</em> (<em>not a number</em>), que equivale a uma posição nula. A lista de valores foi passada para o construtor <em>pd.Series</em> e <em>pandas</em> criou um índice númerico para cada linha e determinou o tipo de  que melhor se representaria os dados (<em>float64</em>). Note que todos os valores passados foram inteiros, menos o <em>NaN</em>, cujo valor é tratado como <em>float64</em>. A criação de <em>DataFrames</em> também é muito simples, porém muito versátil. No exemplo abaixo, criamos uma <em>DataFrame</em> composta por uma matriz de inteiros. Após a chamada ao construtor <em>pd.DataFrame</em>, <em>pandas</em> cria um índice númerico para cada linha e atribui um número como título de cada coluna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <td>3</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos passar mais informações ao construtor da <em>DataFrame</em>, como um nome para cada coluna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <td>3</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos também criar um índice customizado para cada linha. Por exemplo, vamos criar um índice com um intervalo de datas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
    <span class="s1">&#39;20200101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>  <span class="c1"># experimente trocar a string da data por &#39;today&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-01-01</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2020-01-02</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2020-01-03</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <td>2020-01-04</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Uma outra forma de criar uma <em>DataFrame</em> é passar um dicionário com objetos que podem ser convertidos a objetos do tipo <em>Series</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20130102&#39;</span><span class="p">),</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">),</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">),</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;train&quot;</span><span class="p">]),</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>
<span class="p">})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>test</td>
      <td>a</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>b</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>test</td>
      <td>c</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>d</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note que as colunas resultantes tem tipos diferentes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A           float64
B    datetime64[ns]
C           float32
D             int32
E          category
F            object
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="section" id="acessando-os-dados">
<h2><span class="section-number">3.3.1. </span>Acessando os dados<a class="headerlink" href="#acessando-os-dados" title="Permalink to this headline">¶</a></h2>
<p>O pacote oferece diversas formas de acessar os dados contidos em uma <em>DataFrame</em>. Por exemplo, para acessar as primeiras linhas, usa-se o método <em>head</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDE&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
    <tr>
      <td>3</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>20</td>
      <td>21</td>
      <td>22</td>
      <td>23</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se o método <em>head</em> for chamado sem parâmetro algum, ele irá retornar as cinco primeiras linhas da <em>DataFrame</em>. Caso receba um número inteiro, o método irá retornar a quantidade desejada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>De forma similar, podemos acessar as últimas linhas da <em>DataFrame</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>35</td>
      <td>175</td>
      <td>176</td>
      <td>177</td>
      <td>178</td>
      <td>179</td>
    </tr>
    <tr>
      <td>36</td>
      <td>180</td>
      <td>181</td>
      <td>182</td>
      <td>183</td>
      <td>184</td>
    </tr>
    <tr>
      <td>37</td>
      <td>185</td>
      <td>186</td>
      <td>187</td>
      <td>188</td>
      <td>189</td>
    </tr>
    <tr>
      <td>38</td>
      <td>190</td>
      <td>191</td>
      <td>192</td>
      <td>193</td>
      <td>194</td>
    </tr>
    <tr>
      <td>39</td>
      <td>195</td>
      <td>196</td>
      <td>197</td>
      <td>198</td>
      <td>199</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>37</td>
      <td>185</td>
      <td>186</td>
      <td>187</td>
      <td>188</td>
      <td>189</td>
    </tr>
    <tr>
      <td>38</td>
      <td>190</td>
      <td>191</td>
      <td>192</td>
      <td>193</td>
      <td>194</td>
    </tr>
    <tr>
      <td>39</td>
      <td>195</td>
      <td>196</td>
      <td>197</td>
      <td>198</td>
      <td>199</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para listar o índice e as colunas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=40, step=1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Para verificar o formato da tabela, usa-se o atributo <em>shape</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(40, 5)
</pre></div>
</div>
</div>
</div>
<p>O método <em>to_numpy</em> fornece uma representação dos dados na forma de um <em>array</em> de <em>NumPy</em>. Isso pode ser uma operação simples, caso os dados da <em>DataFrame</em> sejam homogêneos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  0,   1,   2,   3,   4],
       [  5,   6,   7,   8,   9],
       [ 10,  11,  12,  13,  14],
       [ 15,  16,  17,  18,  19],
       [ 20,  21,  22,  23,  24],
       [ 25,  26,  27,  28,  29],
       [ 30,  31,  32,  33,  34],
       [ 35,  36,  37,  38,  39],
       [ 40,  41,  42,  43,  44],
       [ 45,  46,  47,  48,  49],
       [ 50,  51,  52,  53,  54],
       [ 55,  56,  57,  58,  59],
       [ 60,  61,  62,  63,  64],
       [ 65,  66,  67,  68,  69],
       [ 70,  71,  72,  73,  74],
       [ 75,  76,  77,  78,  79],
       [ 80,  81,  82,  83,  84],
       [ 85,  86,  87,  88,  89],
       [ 90,  91,  92,  93,  94],
       [ 95,  96,  97,  98,  99],
       [100, 101, 102, 103, 104],
       [105, 106, 107, 108, 109],
       [110, 111, 112, 113, 114],
       [115, 116, 117, 118, 119],
       [120, 121, 122, 123, 124],
       [125, 126, 127, 128, 129],
       [130, 131, 132, 133, 134],
       [135, 136, 137, 138, 139],
       [140, 141, 142, 143, 144],
       [145, 146, 147, 148, 149],
       [150, 151, 152, 153, 154],
       [155, 156, 157, 158, 159],
       [160, 161, 162, 163, 164],
       [165, 166, 167, 168, 169],
       [170, 171, 172, 173, 174],
       [175, 176, 177, 178, 179],
       [180, 181, 182, 183, 184],
       [185, 186, 187, 188, 189],
       [190, 191, 192, 193, 194],
       [195, 196, 197, 198, 199]])
</pre></div>
</div>
</div>
</div>
<p>No entanto, como <em>arrays</em> de <em>NumPy</em> devem ser homogêneos, no caso de <em>DataFrames</em> heterogêneas, a operação pode ser custosa, porque <em>pandas</em> vai precisar encontrar o tipo que melhorar representará todos os dados em um <em>array</em>. Por vezes, esse tipo pode terminar sendo <em>object</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.0, Timestamp(&#39;2013-01-02 00:00:00&#39;), 1.0, 3, &#39;test&#39;, &#39;a&#39;],
       [1.0, Timestamp(&#39;2013-01-02 00:00:00&#39;), 1.0, 3, &#39;train&#39;, &#39;b&#39;],
       [1.0, Timestamp(&#39;2013-01-02 00:00:00&#39;), 1.0, 3, &#39;test&#39;, &#39;c&#39;],
       [1.0, Timestamp(&#39;2013-01-02 00:00:00&#39;), 1.0, 3, &#39;train&#39;, &#39;d&#39;]],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Note que o índice e os nomes das colunas não aparecem na saída de <em>to_numpy</em>. Para transpor a <em>DataFrame</em>, basta accessar o atributo <em>T</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>0</td>
      <td>5</td>
      <td>10</td>
      <td>15</td>
      <td>20</td>
      <td>25</td>
      <td>30</td>
      <td>35</td>
      <td>40</td>
      <td>45</td>
      <td>...</td>
      <td>150</td>
      <td>155</td>
      <td>160</td>
      <td>165</td>
      <td>170</td>
      <td>175</td>
      <td>180</td>
      <td>185</td>
      <td>190</td>
      <td>195</td>
    </tr>
    <tr>
      <td>B</td>
      <td>1</td>
      <td>6</td>
      <td>11</td>
      <td>16</td>
      <td>21</td>
      <td>26</td>
      <td>31</td>
      <td>36</td>
      <td>41</td>
      <td>46</td>
      <td>...</td>
      <td>151</td>
      <td>156</td>
      <td>161</td>
      <td>166</td>
      <td>171</td>
      <td>176</td>
      <td>181</td>
      <td>186</td>
      <td>191</td>
      <td>196</td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td>7</td>
      <td>12</td>
      <td>17</td>
      <td>22</td>
      <td>27</td>
      <td>32</td>
      <td>37</td>
      <td>42</td>
      <td>47</td>
      <td>...</td>
      <td>152</td>
      <td>157</td>
      <td>162</td>
      <td>167</td>
      <td>172</td>
      <td>177</td>
      <td>182</td>
      <td>187</td>
      <td>192</td>
      <td>197</td>
    </tr>
    <tr>
      <td>D</td>
      <td>3</td>
      <td>8</td>
      <td>13</td>
      <td>18</td>
      <td>23</td>
      <td>28</td>
      <td>33</td>
      <td>38</td>
      <td>43</td>
      <td>48</td>
      <td>...</td>
      <td>153</td>
      <td>158</td>
      <td>163</td>
      <td>168</td>
      <td>173</td>
      <td>178</td>
      <td>183</td>
      <td>188</td>
      <td>193</td>
      <td>198</td>
    </tr>
    <tr>
      <td>E</td>
      <td>4</td>
      <td>9</td>
      <td>14</td>
      <td>19</td>
      <td>24</td>
      <td>29</td>
      <td>34</td>
      <td>39</td>
      <td>44</td>
      <td>49</td>
      <td>...</td>
      <td>154</td>
      <td>159</td>
      <td>164</td>
      <td>169</td>
      <td>174</td>
      <td>179</td>
      <td>184</td>
      <td>189</td>
      <td>194</td>
      <td>199</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div></div></div>
</div>
<p>Para acessar uma única coluna, retornada como uma <em>Series</em>, podemos usar notação de colchetes ou de atributo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     test
1    train
2     test
3    train
Name: E, dtype: category
Categories (2, object): [test, train]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">E</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     test
1    train
2     test
3    train
Name: E, dtype: category
Categories (2, object): [test, train]
</pre></div>
</div>
</div>
</div>
<p>Para acessar linhas pelos seus índices, podemos usar o atributo <em>loc</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
    <span class="s1">&#39;20200101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span>
<span class="p">)</span>

<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0
B    1
C    2
Name: 2020-01-01 00:00:00, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>O atributo <em>loc</em> também permite acessar listas de índices, bem como especificar quais colunas devem ser retornadas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">dates</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">dates</span><span class="p">[</span><span class="mi">4</span><span class="p">]]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-01-03</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <td>2020-01-05</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">dates</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">dates</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-01-03</td>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <td>2020-01-05</td>
      <td>12</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se apenas um índice e uma coluna forem especificados, <em>pandas</em> retornará o valor correspondente da tabela:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Note a diferença de comportamento se a única coluna for informada dentro de uma lista:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df3</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span>  <span class="c1"># retorna uma Series com apenas um elemento</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>B    1
Name: 2020-01-01 00:00:00, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Para acessar apenas um valor de forma mais rápida, o atributo <em>loc</em> pode ser substituído por <em>at</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">df3</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Similar ao <em>loc</em>, o atributo <em>iloc</em> também permite acessar os dados da <em>DataFrame</em>, porém ao invés de acessar através dos valores dos índices, ele permite acessar pelas posições das linhas. Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># equivale a df3.loc[df3.index[0]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0
B    1
C    2
Name: 2020-01-01 00:00:00, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>As colunas também são tratadas numericamente por <em>iloc</em>. Inclusive, é possível usá-lo para acessar fatias da tabela, assim como em um <em>array</em> de <em>NumPy</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0
C    2
Name: 2020-01-01 00:00:00, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># exclui o final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-01-01</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2020-01-02</td>
      <td>3</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Continuando as similaridades com <em>arrays</em>, também é possível acessar os dados de uma <em>DataFrame</em> usando condições booleanas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="o">.</span><span class="n">A</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># apenas as linhas em que a coluna A é par</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
    <tr>
      <td>4</td>
      <td>20</td>
      <td>21</td>
      <td>22</td>
      <td>23</td>
      <td>24</td>
    </tr>
    <tr>
      <td>6</td>
      <td>30</td>
      <td>31</td>
      <td>32</td>
      <td>33</td>
      <td>34</td>
    </tr>
    <tr>
      <td>8</td>
      <td>40</td>
      <td>41</td>
      <td>42</td>
      <td>43</td>
      <td>44</td>
    </tr>
    <tr>
      <td>10</td>
      <td>50</td>
      <td>51</td>
      <td>52</td>
      <td>53</td>
      <td>54</td>
    </tr>
    <tr>
      <td>12</td>
      <td>60</td>
      <td>61</td>
      <td>62</td>
      <td>63</td>
      <td>64</td>
    </tr>
    <tr>
      <td>14</td>
      <td>70</td>
      <td>71</td>
      <td>72</td>
      <td>73</td>
      <td>74</td>
    </tr>
    <tr>
      <td>16</td>
      <td>80</td>
      <td>81</td>
      <td>82</td>
      <td>83</td>
      <td>84</td>
    </tr>
    <tr>
      <td>18</td>
      <td>90</td>
      <td>91</td>
      <td>92</td>
      <td>93</td>
      <td>94</td>
    </tr>
    <tr>
      <td>20</td>
      <td>100</td>
      <td>101</td>
      <td>102</td>
      <td>103</td>
      <td>104</td>
    </tr>
    <tr>
      <td>22</td>
      <td>110</td>
      <td>111</td>
      <td>112</td>
      <td>113</td>
      <td>114</td>
    </tr>
    <tr>
      <td>24</td>
      <td>120</td>
      <td>121</td>
      <td>122</td>
      <td>123</td>
      <td>124</td>
    </tr>
    <tr>
      <td>26</td>
      <td>130</td>
      <td>131</td>
      <td>132</td>
      <td>133</td>
      <td>134</td>
    </tr>
    <tr>
      <td>28</td>
      <td>140</td>
      <td>141</td>
      <td>142</td>
      <td>143</td>
      <td>144</td>
    </tr>
    <tr>
      <td>30</td>
      <td>150</td>
      <td>151</td>
      <td>152</td>
      <td>153</td>
      <td>154</td>
    </tr>
    <tr>
      <td>32</td>
      <td>160</td>
      <td>161</td>
      <td>162</td>
      <td>163</td>
      <td>164</td>
    </tr>
    <tr>
      <td>34</td>
      <td>170</td>
      <td>171</td>
      <td>172</td>
      <td>173</td>
      <td>174</td>
    </tr>
    <tr>
      <td>36</td>
      <td>180</td>
      <td>181</td>
      <td>182</td>
      <td>183</td>
      <td>184</td>
    </tr>
    <tr>
      <td>38</td>
      <td>190</td>
      <td>191</td>
      <td>192</td>
      <td>193</td>
      <td>194</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="n">df2</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Apenas os valores pares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>14.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>NaN</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>4</td>
      <td>20.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>24.0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>28.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>6</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>32.0</td>
      <td>NaN</td>
      <td>34.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>NaN</td>
      <td>36.0</td>
      <td>NaN</td>
      <td>38.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>8</td>
      <td>40.0</td>
      <td>NaN</td>
      <td>42.0</td>
      <td>NaN</td>
      <td>44.0</td>
    </tr>
    <tr>
      <td>9</td>
      <td>NaN</td>
      <td>46.0</td>
      <td>NaN</td>
      <td>48.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>10</td>
      <td>50.0</td>
      <td>NaN</td>
      <td>52.0</td>
      <td>NaN</td>
      <td>54.0</td>
    </tr>
    <tr>
      <td>11</td>
      <td>NaN</td>
      <td>56.0</td>
      <td>NaN</td>
      <td>58.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>12</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>62.0</td>
      <td>NaN</td>
      <td>64.0</td>
    </tr>
    <tr>
      <td>13</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>68.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>14</td>
      <td>70.0</td>
      <td>NaN</td>
      <td>72.0</td>
      <td>NaN</td>
      <td>74.0</td>
    </tr>
    <tr>
      <td>15</td>
      <td>NaN</td>
      <td>76.0</td>
      <td>NaN</td>
      <td>78.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>16</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>82.0</td>
      <td>NaN</td>
      <td>84.0</td>
    </tr>
    <tr>
      <td>17</td>
      <td>NaN</td>
      <td>86.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>18</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>92.0</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <td>19</td>
      <td>NaN</td>
      <td>96.0</td>
      <td>NaN</td>
      <td>98.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>20</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>102.0</td>
      <td>NaN</td>
      <td>104.0</td>
    </tr>
    <tr>
      <td>21</td>
      <td>NaN</td>
      <td>106.0</td>
      <td>NaN</td>
      <td>108.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>22</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>112.0</td>
      <td>NaN</td>
      <td>114.0</td>
    </tr>
    <tr>
      <td>23</td>
      <td>NaN</td>
      <td>116.0</td>
      <td>NaN</td>
      <td>118.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>24</td>
      <td>120.0</td>
      <td>NaN</td>
      <td>122.0</td>
      <td>NaN</td>
      <td>124.0</td>
    </tr>
    <tr>
      <td>25</td>
      <td>NaN</td>
      <td>126.0</td>
      <td>NaN</td>
      <td>128.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>26</td>
      <td>130.0</td>
      <td>NaN</td>
      <td>132.0</td>
      <td>NaN</td>
      <td>134.0</td>
    </tr>
    <tr>
      <td>27</td>
      <td>NaN</td>
      <td>136.0</td>
      <td>NaN</td>
      <td>138.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>28</td>
      <td>140.0</td>
      <td>NaN</td>
      <td>142.0</td>
      <td>NaN</td>
      <td>144.0</td>
    </tr>
    <tr>
      <td>29</td>
      <td>NaN</td>
      <td>146.0</td>
      <td>NaN</td>
      <td>148.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>30</td>
      <td>150.0</td>
      <td>NaN</td>
      <td>152.0</td>
      <td>NaN</td>
      <td>154.0</td>
    </tr>
    <tr>
      <td>31</td>
      <td>NaN</td>
      <td>156.0</td>
      <td>NaN</td>
      <td>158.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>32</td>
      <td>160.0</td>
      <td>NaN</td>
      <td>162.0</td>
      <td>NaN</td>
      <td>164.0</td>
    </tr>
    <tr>
      <td>33</td>
      <td>NaN</td>
      <td>166.0</td>
      <td>NaN</td>
      <td>168.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>34</td>
      <td>170.0</td>
      <td>NaN</td>
      <td>172.0</td>
      <td>NaN</td>
      <td>174.0</td>
    </tr>
    <tr>
      <td>35</td>
      <td>NaN</td>
      <td>176.0</td>
      <td>NaN</td>
      <td>178.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>36</td>
      <td>180.0</td>
      <td>NaN</td>
      <td>182.0</td>
      <td>NaN</td>
      <td>184.0</td>
    </tr>
    <tr>
      <td>37</td>
      <td>NaN</td>
      <td>186.0</td>
      <td>NaN</td>
      <td>188.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>38</td>
      <td>190.0</td>
      <td>NaN</td>
      <td>192.0</td>
      <td>NaN</td>
      <td>194.0</td>
    </tr>
    <tr>
      <td>39</td>
      <td>NaN</td>
      <td>196.0</td>
      <td>NaN</td>
      <td>198.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O método <em>isin</em> permite filtrar dados:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>test</td>
      <td>a</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>d</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Além de acessar dados, <em>loc</em>, <em>iloc</em>, <em>at</em> e <em>iat</em> permitem atribuir valores às posições indicadas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-01-01</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2020-01-02</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2020-01-03</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2020-01-04</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <td>2020-01-05</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
    <tr>
      <td>2020-01-06</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20200101&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-01-01</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <td>2020-01-02</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2020-01-03</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2020-01-04</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <td>2020-01-05</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
    <tr>
      <td>2020-01-06</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>

<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-01-01</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <td>2020-01-02</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2020-01-03</td>
      <td>1</td>
      <td>1</td>
      <td>-5</td>
    </tr>
    <tr>
      <td>2020-01-04</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <td>2020-01-05</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
    <tr>
      <td>2020-01-06</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Também é possível usar máscaras booleanas para atribuir valores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="n">df2</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">df2</span>

<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>-2</td>
      <td>3</td>
      <td>-4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>5</td>
      <td>-6</td>
      <td>7</td>
      <td>-8</td>
      <td>9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-10</td>
      <td>11</td>
      <td>-12</td>
      <td>13</td>
      <td>-14</td>
    </tr>
    <tr>
      <td>3</td>
      <td>15</td>
      <td>-16</td>
      <td>17</td>
      <td>-18</td>
      <td>19</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-20</td>
      <td>21</td>
      <td>-22</td>
      <td>23</td>
      <td>-24</td>
    </tr>
    <tr>
      <td>5</td>
      <td>25</td>
      <td>-26</td>
      <td>27</td>
      <td>-28</td>
      <td>29</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-30</td>
      <td>31</td>
      <td>-32</td>
      <td>33</td>
      <td>-34</td>
    </tr>
    <tr>
      <td>7</td>
      <td>35</td>
      <td>-36</td>
      <td>37</td>
      <td>-38</td>
      <td>39</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-40</td>
      <td>41</td>
      <td>-42</td>
      <td>43</td>
      <td>-44</td>
    </tr>
    <tr>
      <td>9</td>
      <td>45</td>
      <td>-46</td>
      <td>47</td>
      <td>-48</td>
      <td>49</td>
    </tr>
    <tr>
      <td>10</td>
      <td>-50</td>
      <td>51</td>
      <td>-52</td>
      <td>53</td>
      <td>-54</td>
    </tr>
    <tr>
      <td>11</td>
      <td>55</td>
      <td>-56</td>
      <td>57</td>
      <td>-58</td>
      <td>59</td>
    </tr>
    <tr>
      <td>12</td>
      <td>-60</td>
      <td>61</td>
      <td>-62</td>
      <td>63</td>
      <td>-64</td>
    </tr>
    <tr>
      <td>13</td>
      <td>65</td>
      <td>-66</td>
      <td>67</td>
      <td>-68</td>
      <td>69</td>
    </tr>
    <tr>
      <td>14</td>
      <td>-70</td>
      <td>71</td>
      <td>-72</td>
      <td>73</td>
      <td>-74</td>
    </tr>
    <tr>
      <td>15</td>
      <td>75</td>
      <td>-76</td>
      <td>77</td>
      <td>-78</td>
      <td>79</td>
    </tr>
    <tr>
      <td>16</td>
      <td>-80</td>
      <td>81</td>
      <td>-82</td>
      <td>83</td>
      <td>-84</td>
    </tr>
    <tr>
      <td>17</td>
      <td>85</td>
      <td>-86</td>
      <td>87</td>
      <td>-88</td>
      <td>89</td>
    </tr>
    <tr>
      <td>18</td>
      <td>-90</td>
      <td>91</td>
      <td>-92</td>
      <td>93</td>
      <td>-94</td>
    </tr>
    <tr>
      <td>19</td>
      <td>95</td>
      <td>-96</td>
      <td>97</td>
      <td>-98</td>
      <td>99</td>
    </tr>
    <tr>
      <td>20</td>
      <td>-100</td>
      <td>101</td>
      <td>-102</td>
      <td>103</td>
      <td>-104</td>
    </tr>
    <tr>
      <td>21</td>
      <td>105</td>
      <td>-106</td>
      <td>107</td>
      <td>-108</td>
      <td>109</td>
    </tr>
    <tr>
      <td>22</td>
      <td>-110</td>
      <td>111</td>
      <td>-112</td>
      <td>113</td>
      <td>-114</td>
    </tr>
    <tr>
      <td>23</td>
      <td>115</td>
      <td>-116</td>
      <td>117</td>
      <td>-118</td>
      <td>119</td>
    </tr>
    <tr>
      <td>24</td>
      <td>-120</td>
      <td>121</td>
      <td>-122</td>
      <td>123</td>
      <td>-124</td>
    </tr>
    <tr>
      <td>25</td>
      <td>125</td>
      <td>-126</td>
      <td>127</td>
      <td>-128</td>
      <td>129</td>
    </tr>
    <tr>
      <td>26</td>
      <td>-130</td>
      <td>131</td>
      <td>-132</td>
      <td>133</td>
      <td>-134</td>
    </tr>
    <tr>
      <td>27</td>
      <td>135</td>
      <td>-136</td>
      <td>137</td>
      <td>-138</td>
      <td>139</td>
    </tr>
    <tr>
      <td>28</td>
      <td>-140</td>
      <td>141</td>
      <td>-142</td>
      <td>143</td>
      <td>-144</td>
    </tr>
    <tr>
      <td>29</td>
      <td>145</td>
      <td>-146</td>
      <td>147</td>
      <td>-148</td>
      <td>149</td>
    </tr>
    <tr>
      <td>30</td>
      <td>-150</td>
      <td>151</td>
      <td>-152</td>
      <td>153</td>
      <td>-154</td>
    </tr>
    <tr>
      <td>31</td>
      <td>155</td>
      <td>-156</td>
      <td>157</td>
      <td>-158</td>
      <td>159</td>
    </tr>
    <tr>
      <td>32</td>
      <td>-160</td>
      <td>161</td>
      <td>-162</td>
      <td>163</td>
      <td>-164</td>
    </tr>
    <tr>
      <td>33</td>
      <td>165</td>
      <td>-166</td>
      <td>167</td>
      <td>-168</td>
      <td>169</td>
    </tr>
    <tr>
      <td>34</td>
      <td>-170</td>
      <td>171</td>
      <td>-172</td>
      <td>173</td>
      <td>-174</td>
    </tr>
    <tr>
      <td>35</td>
      <td>175</td>
      <td>-176</td>
      <td>177</td>
      <td>-178</td>
      <td>179</td>
    </tr>
    <tr>
      <td>36</td>
      <td>-180</td>
      <td>181</td>
      <td>-182</td>
      <td>183</td>
      <td>-184</td>
    </tr>
    <tr>
      <td>37</td>
      <td>185</td>
      <td>-186</td>
      <td>187</td>
      <td>-188</td>
      <td>189</td>
    </tr>
    <tr>
      <td>38</td>
      <td>-190</td>
      <td>191</td>
      <td>-192</td>
      <td>193</td>
      <td>-194</td>
    </tr>
    <tr>
      <td>39</td>
      <td>195</td>
      <td>-196</td>
      <td>197</td>
      <td>-198</td>
      <td>199</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para adicionar uma nova coluna, basta usar a notação de colchetes com o nome da nova coluna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>-2</td>
      <td>3</td>
      <td>-4</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>5</td>
      <td>-6</td>
      <td>7</td>
      <td>-8</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-10</td>
      <td>11</td>
      <td>-12</td>
      <td>13</td>
      <td>-14</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>15</td>
      <td>-16</td>
      <td>17</td>
      <td>-18</td>
      <td>19</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-20</td>
      <td>21</td>
      <td>-22</td>
      <td>23</td>
      <td>-24</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>25</td>
      <td>-26</td>
      <td>27</td>
      <td>-28</td>
      <td>29</td>
      <td>1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-30</td>
      <td>31</td>
      <td>-32</td>
      <td>33</td>
      <td>-34</td>
      <td>1</td>
    </tr>
    <tr>
      <td>7</td>
      <td>35</td>
      <td>-36</td>
      <td>37</td>
      <td>-38</td>
      <td>39</td>
      <td>1</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-40</td>
      <td>41</td>
      <td>-42</td>
      <td>43</td>
      <td>-44</td>
      <td>1</td>
    </tr>
    <tr>
      <td>9</td>
      <td>45</td>
      <td>-46</td>
      <td>47</td>
      <td>-48</td>
      <td>49</td>
      <td>1</td>
    </tr>
    <tr>
      <td>10</td>
      <td>-50</td>
      <td>51</td>
      <td>-52</td>
      <td>53</td>
      <td>-54</td>
      <td>1</td>
    </tr>
    <tr>
      <td>11</td>
      <td>55</td>
      <td>-56</td>
      <td>57</td>
      <td>-58</td>
      <td>59</td>
      <td>1</td>
    </tr>
    <tr>
      <td>12</td>
      <td>-60</td>
      <td>61</td>
      <td>-62</td>
      <td>63</td>
      <td>-64</td>
      <td>1</td>
    </tr>
    <tr>
      <td>13</td>
      <td>65</td>
      <td>-66</td>
      <td>67</td>
      <td>-68</td>
      <td>69</td>
      <td>1</td>
    </tr>
    <tr>
      <td>14</td>
      <td>-70</td>
      <td>71</td>
      <td>-72</td>
      <td>73</td>
      <td>-74</td>
      <td>1</td>
    </tr>
    <tr>
      <td>15</td>
      <td>75</td>
      <td>-76</td>
      <td>77</td>
      <td>-78</td>
      <td>79</td>
      <td>1</td>
    </tr>
    <tr>
      <td>16</td>
      <td>-80</td>
      <td>81</td>
      <td>-82</td>
      <td>83</td>
      <td>-84</td>
      <td>1</td>
    </tr>
    <tr>
      <td>17</td>
      <td>85</td>
      <td>-86</td>
      <td>87</td>
      <td>-88</td>
      <td>89</td>
      <td>1</td>
    </tr>
    <tr>
      <td>18</td>
      <td>-90</td>
      <td>91</td>
      <td>-92</td>
      <td>93</td>
      <td>-94</td>
      <td>1</td>
    </tr>
    <tr>
      <td>19</td>
      <td>95</td>
      <td>-96</td>
      <td>97</td>
      <td>-98</td>
      <td>99</td>
      <td>1</td>
    </tr>
    <tr>
      <td>20</td>
      <td>-100</td>
      <td>101</td>
      <td>-102</td>
      <td>103</td>
      <td>-104</td>
      <td>1</td>
    </tr>
    <tr>
      <td>21</td>
      <td>105</td>
      <td>-106</td>
      <td>107</td>
      <td>-108</td>
      <td>109</td>
      <td>1</td>
    </tr>
    <tr>
      <td>22</td>
      <td>-110</td>
      <td>111</td>
      <td>-112</td>
      <td>113</td>
      <td>-114</td>
      <td>1</td>
    </tr>
    <tr>
      <td>23</td>
      <td>115</td>
      <td>-116</td>
      <td>117</td>
      <td>-118</td>
      <td>119</td>
      <td>1</td>
    </tr>
    <tr>
      <td>24</td>
      <td>-120</td>
      <td>121</td>
      <td>-122</td>
      <td>123</td>
      <td>-124</td>
      <td>1</td>
    </tr>
    <tr>
      <td>25</td>
      <td>125</td>
      <td>-126</td>
      <td>127</td>
      <td>-128</td>
      <td>129</td>
      <td>1</td>
    </tr>
    <tr>
      <td>26</td>
      <td>-130</td>
      <td>131</td>
      <td>-132</td>
      <td>133</td>
      <td>-134</td>
      <td>1</td>
    </tr>
    <tr>
      <td>27</td>
      <td>135</td>
      <td>-136</td>
      <td>137</td>
      <td>-138</td>
      <td>139</td>
      <td>1</td>
    </tr>
    <tr>
      <td>28</td>
      <td>-140</td>
      <td>141</td>
      <td>-142</td>
      <td>143</td>
      <td>-144</td>
      <td>1</td>
    </tr>
    <tr>
      <td>29</td>
      <td>145</td>
      <td>-146</td>
      <td>147</td>
      <td>-148</td>
      <td>149</td>
      <td>1</td>
    </tr>
    <tr>
      <td>30</td>
      <td>-150</td>
      <td>151</td>
      <td>-152</td>
      <td>153</td>
      <td>-154</td>
      <td>1</td>
    </tr>
    <tr>
      <td>31</td>
      <td>155</td>
      <td>-156</td>
      <td>157</td>
      <td>-158</td>
      <td>159</td>
      <td>1</td>
    </tr>
    <tr>
      <td>32</td>
      <td>-160</td>
      <td>161</td>
      <td>-162</td>
      <td>163</td>
      <td>-164</td>
      <td>1</td>
    </tr>
    <tr>
      <td>33</td>
      <td>165</td>
      <td>-166</td>
      <td>167</td>
      <td>-168</td>
      <td>169</td>
      <td>1</td>
    </tr>
    <tr>
      <td>34</td>
      <td>-170</td>
      <td>171</td>
      <td>-172</td>
      <td>173</td>
      <td>-174</td>
      <td>1</td>
    </tr>
    <tr>
      <td>35</td>
      <td>175</td>
      <td>-176</td>
      <td>177</td>
      <td>-178</td>
      <td>179</td>
      <td>1</td>
    </tr>
    <tr>
      <td>36</td>
      <td>-180</td>
      <td>181</td>
      <td>-182</td>
      <td>183</td>
      <td>-184</td>
      <td>1</td>
    </tr>
    <tr>
      <td>37</td>
      <td>185</td>
      <td>-186</td>
      <td>187</td>
      <td>-188</td>
      <td>189</td>
      <td>1</td>
    </tr>
    <tr>
      <td>38</td>
      <td>-190</td>
      <td>191</td>
      <td>-192</td>
      <td>193</td>
      <td>-194</td>
      <td>1</td>
    </tr>
    <tr>
      <td>39</td>
      <td>195</td>
      <td>-196</td>
      <td>197</td>
      <td>-198</td>
      <td>199</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="estatistica-descritiva">
<h2><span class="section-number">3.3.2. </span>Estatística descritiva<a class="headerlink" href="#estatistica-descritiva" title="Permalink to this headline">¶</a></h2>
<p>O pacote <em>pandas</em> oferece diversas funções para análise de Estatística descritiva. A mais geral dessas funcionalidades é o método <em>describe</em>, que computa uma variedade de medidas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.0</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>std</td>
      <td>114.718161</td>
      <td>115.591012</td>
      <td>116.466128</td>
      <td>117.343458</td>
      <td>118.222953</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>min</td>
      <td>-190.000000</td>
      <td>-196.000000</td>
      <td>-192.000000</td>
      <td>-198.000000</td>
      <td>-194.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>-92.500000</td>
      <td>-98.500000</td>
      <td>-94.500000</td>
      <td>-100.500000</td>
      <td>-96.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>97.500000</td>
      <td>93.500000</td>
      <td>99.500000</td>
      <td>95.500000</td>
      <td>101.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>max</td>
      <td>195.000000</td>
      <td>191.000000</td>
      <td>197.000000</td>
      <td>193.000000</td>
      <td>199.000000</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>É possivel selecionar os percentis que serão incluídos (a mediana é sempre retornada por padrão):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.000000</td>
      <td>40.0</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>std</td>
      <td>114.718161</td>
      <td>115.591012</td>
      <td>116.466128</td>
      <td>117.343458</td>
      <td>118.222953</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>min</td>
      <td>-190.000000</td>
      <td>-196.000000</td>
      <td>-192.000000</td>
      <td>-198.000000</td>
      <td>-194.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>5%</td>
      <td>-170.500000</td>
      <td>-176.500000</td>
      <td>-172.500000</td>
      <td>-178.500000</td>
      <td>-174.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>-92.500000</td>
      <td>-98.500000</td>
      <td>-94.500000</td>
      <td>-100.500000</td>
      <td>-96.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>-2.500000</td>
      <td>2.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>97.500000</td>
      <td>93.500000</td>
      <td>99.500000</td>
      <td>95.500000</td>
      <td>101.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>95%</td>
      <td>175.500000</td>
      <td>171.500000</td>
      <td>177.500000</td>
      <td>173.500000</td>
      <td>179.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>max</td>
      <td>195.000000</td>
      <td>191.000000</td>
      <td>197.000000</td>
      <td>193.000000</td>
      <td>199.000000</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para colunas não-númericas, <em>describe</em> retorna um sumário mais simples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count         4
unique        2
top       train
freq          2
Name: E, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Numa <em>DataFrame</em> com tipos mistos, <em>describe</em> irá incluir apenas as colunas numéricas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)})</span>

<span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>std</td>
      <td>1.290994</td>
    </tr>
    <tr>
      <td>min</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>2.250000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Esse comportamento pode ser controlado pelos argumentos <em>include</em> e <em>exclude</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>4</td>
    </tr>
    <tr>
      <td>unique</td>
      <td>2</td>
    </tr>
    <tr>
      <td>top</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>freq</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>std</td>
      <td>1.290994</td>
    </tr>
    <tr>
      <td>min</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>2.250000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;number&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>4</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <td>unique</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>top</td>
      <td>Yes</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>freq</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>NaN</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>std</td>
      <td>NaN</td>
      <td>1.290994</td>
    </tr>
    <tr>
      <td>min</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>NaN</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>NaN</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>NaN</td>
      <td>2.250000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>NaN</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>4</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <td>unique</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>top</td>
      <td>Yes</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>freq</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>NaN</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>std</td>
      <td>NaN</td>
      <td>1.290994</td>
    </tr>
    <tr>
      <td>min</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>NaN</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>NaN</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>NaN</td>
      <td>2.250000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>NaN</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Cada uma das funções separadas de estatística descritiva pode ser calculada para um dado eixo (<em>axis</em>), assim como <em>NumPy</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="p">})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-0.254453</td>
      <td>1.441788</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.505071</td>
      <td>0.330944</td>
      <td>0.516516</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.579231</td>
      <td>-2.034135</td>
      <td>-0.706711</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-0.165479</td>
      <td>-1.365275</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one     -0.109538
two     -0.106720
three   -0.518490
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0.593668
b    0.450843
c   -1.106692
d   -0.765377
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Diferente de <em>NumPy</em>, se o eixo não for informado, o padrão é <em>axis=0</em> (<em>NumPy</em> calcula a média para o <em>array</em> todo).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one     -0.109538
two     -0.106720
three   -0.518490
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Note que os valores <em>NaN</em> são descartados. Isso pode ser controlado pelo argumento <em>skipna</em>, que é <em>True</em> por padrão:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one          NaN
two     -0.10672
three        NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Combinando comportameto aritmético e <em>broadcasting</em>, é possível realizar operações estatísticas, como a padronização (média 0 e desvio 1), de forma concisa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_stand</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">df_stand</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one      1.0
two      1.0
three    1.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_stand</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">df_stand</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    1.0
b    1.0
c    1.0
d    1.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Métodos como <em>cumsum</em> (soma acumulada) e <em>cumprod</em> (produto acumulado) preservam a posição de valores <em>NaN</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-0.254453</td>
      <td>1.441788</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.250617</td>
      <td>1.772732</td>
      <td>0.516516</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.328613</td>
      <td>-0.261403</td>
      <td>-0.190195</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-0.426881</td>
      <td>-1.555471</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-0.254453</td>
      <td>-0.366868</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.505071</td>
      <td>0.167150</td>
      <td>0.086336</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.579231</td>
      <td>1.178233</td>
      <td>-0.832670</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-0.165479</td>
      <td>0.225924</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A tabela abaixo oferece um sumário de funções comumente usadas:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Função</p></th>
<th class="head"><p>Convenção</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>count</em></p></td>
<td><p>número de observações não-<em>NaN</em></p></td>
</tr>
<tr class="row-odd"><td><p><em>sum</em></p></td>
<td><p>soma dos valores</p></td>
</tr>
<tr class="row-even"><td><p><em>mean</em></p></td>
<td><p>média dos valores</p></td>
</tr>
<tr class="row-odd"><td><p><em>mad</em></p></td>
<td><p>desvio absoluto médio</p></td>
</tr>
<tr class="row-even"><td><p><em>median</em></p></td>
<td><p>mediana dos valores</p></td>
</tr>
<tr class="row-odd"><td><p><em>min</em></p></td>
<td><p>mínimo</p></td>
</tr>
<tr class="row-even"><td><p><em>max</em></p></td>
<td><p>máximo</p></td>
</tr>
<tr class="row-odd"><td><p><em>mode</em></p></td>
<td><p>moda</p></td>
</tr>
<tr class="row-even"><td><p><em>abs</em></p></td>
<td><p>valores absolutos</p></td>
</tr>
<tr class="row-odd"><td><p><em>prod</em></p></td>
<td><p>produto dos valores</p></td>
</tr>
<tr class="row-even"><td><p><em>std</em></p></td>
<td><p>desvio padrão amostral</p></td>
</tr>
<tr class="row-odd"><td><p><em>var</em></p></td>
<td><p>variância amostral</p></td>
</tr>
<tr class="row-even"><td><p><em>skew</em></p></td>
<td><p>assimetria amostral</p></td>
</tr>
<tr class="row-odd"><td><p><em>kurt</em></p></td>
<td><p>curtose amostral</p></td>
</tr>
<tr class="row-even"><td><p><em>quantile</em></p></td>
<td><p>quantis amostrais</p></td>
</tr>
<tr class="row-odd"><td><p><em>cumsum</em></p></td>
<td><p>soma acumulada</p></td>
</tr>
<tr class="row-even"><td><p><em>cumprod</em></p></td>
<td><p>produto acumulado</p></td>
</tr>
<tr class="row-odd"><td><p><em>cummax</em></p></td>
<td><p>máximo acumulado</p></td>
</tr>
<tr class="row-even"><td><p><em>cummin</em></p></td>
<td><p>mínimo acumulado</p></td>
</tr>
</tbody>
</table>
<p>As funções <em>idxmin</em> e <em>idxmax</em> retornam os índices dos menores e maiores valores, respectivamente, através do eixo informado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one      c
two      c
three    d
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a      two
b    three
c      one
d      two
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Os objetos do tipo <em>Series</em> disponibilizam um método chamado <em>value_counts</em> (que também pode ser usado como uma função) que computa um histograma de um <em>array</em> unidimensional:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([6, 2, 6, 2, 4, 2, 4, 6, 5, 3, 5, 0, 5, 3, 1, 5, 5, 4, 4, 2, 4, 3,
       3, 2, 1, 1, 4, 6, 1, 3, 1, 4, 4, 3, 5, 5, 1, 3, 0, 6, 4, 6, 2, 3,
       5, 5, 3, 6, 1, 6])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5    9
4    9
3    9
6    8
1    7
2    6
0    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5    9
4    9
3    9
6    8
1    7
2    6
0    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Valores contínuos podem ser discretizados usando as funções <em>cut</em> (intervalos baseados nos valores) e <em>qcut</em> (intervalos baseados nos quantis).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">factor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(-1.767, -0.671], (0.426, 1.523], (-0.671, 0.426], (-0.671, 0.426], (-0.671, 0.426], ..., (0.426, 1.523], (-0.671, 0.426], (-1.767, -0.671], (-0.671, 0.426], (-1.767, -0.671]]
Length: 20
Categories (4, interval[float64]): [(-2.868, -1.767] &lt; (-1.767, -0.671] &lt; (-0.671, 0.426] &lt; (0.426, 1.523]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">factor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(-5, -1], (0, 1], (0, 1], (-1, 0], (-1, 0], ..., (1, 5], (0, 1], (-5, -1], (-1, 0], (-5, -1]]
Length: 20
Categories (4, interval[int64]): [(-5, -1] &lt; (-1, 0] &lt; (0, 1] &lt; (1, 5]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 1]      6
(-1, 0]     6
(-5, -1]    5
(1, 5]      3
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">factor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(-2.8649999999999998, -0.999], (0.683, 1.523], (-0.275, 0.683], (-0.275, 0.683], (-0.999, -0.275], ..., (0.683, 1.523], (-0.275, 0.683], (-2.8649999999999998, -0.999], (-0.999, -0.275], (-2.8649999999999998, -0.999]]
Length: 20
Categories (4, interval[float64]): [(-2.8649999999999998, -0.999] &lt; (-0.999, -0.275] &lt; (-0.275, 0.683] &lt; (0.683, 1.523]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.683, 1.523]                   5
(-0.275, 0.683]                  5
(-0.999, -0.275]                 5
(-2.8649999999999998, -0.999]    5
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ordenando-valores">
<h2><span class="section-number">3.3.3. </span>Ordenando valores<a class="headerlink" href="#ordenando-valores" title="Permalink to this headline">¶</a></h2>
<p>Três formas de ordenação estão disponíveis em <em>pandas</em>: pelos índices, pelas colunas e pelas duas coisas. Os métodos <em>Series.sort_index()</em> e <em>DataFrame.sort_index()</em> são usados para ordenar objetos <em>pandas</em> pelos seus índices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
     <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
     <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]),</span>
     <span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="p">})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-2.677236</td>
      <td>0.918163</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.183756</td>
      <td>0.264308</td>
      <td>-0.950005</td>
    </tr>
    <tr>
      <td>c</td>
      <td>1.485703</td>
      <td>-1.821698</td>
      <td>0.390643</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.780344</td>
      <td>0.467211</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.780344</td>
      <td>0.467211</td>
    </tr>
    <tr>
      <td>c</td>
      <td>1.485703</td>
      <td>-1.821698</td>
      <td>0.390643</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.183756</td>
      <td>0.264308</td>
      <td>-0.950005</td>
    </tr>
    <tr>
      <td>a</td>
      <td>-2.677236</td>
      <td>0.918163</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-2.677236</td>
      <td>NaN</td>
      <td>0.918163</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.183756</td>
      <td>-0.950005</td>
      <td>0.264308</td>
    </tr>
    <tr>
      <td>c</td>
      <td>1.485703</td>
      <td>0.390643</td>
      <td>-1.821698</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>0.467211</td>
      <td>-1.780344</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d    0.467211
c    0.390643
b   -0.950005
a         NaN
Name: three, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>O método <em>Series.sort_values()</em> é usado para ordenar uma <em>Series</em> pelos seus valores. Já o método <em>DataFrame.sort_values()</em> pode ser usado para ordenar uma <em>DataFrame</em> pelos valores das linhas ou das colunas e tem um parâmetro opcional <em>by=</em> que serve para especificar uma ou mais colunas para determinar a ordem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                    <span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;two&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="p">[[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Esses métodos tem um tratamento especial para valores faltantes, por meio do parâmetro <em>na_position</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;Aaba&#39;</span><span class="p">,</span> <span class="s1">&#39;Baca&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;CABA&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;object&quot;</span>
<span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       A
3    Aaba
1       B
4    Baca
6    CABA
8     cat
7     dog
2     NaN
5     NaN
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">na_position</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2     NaN
5     NaN
0       A
3    Aaba
1       B
4    Baca
6    CABA
8     cat
7     dog
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Strings passadas para o argumento <em>by=</em> podem se referir a colunas ou nomes de índices. Aliás, esse é um bom momento para introduzir índices múltiplos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span>
    <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="p">)</span>

<span class="n">idx</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">]</span>

<span class="n">df_multi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)},</span>
    <span class="n">index</span><span class="o">=</span><span class="n">idx</span>
<span class="p">)</span>

<span class="n">df_multi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3" valign="top">a</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <td rowspan="3" valign="top">b</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_multi</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="2" valign="top">b</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>a</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <td>b</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td rowspan="2" valign="top">a</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><em>Series</em> também oferece os métodos <em>nsmallest()</em> e <em>nlargest()</em>, que retornam os menores ou maiores <em>n</em> valores, o que pode ser bem mais eficiente do que ordenar a <em>Series</em> toda só para chamar <em>tail(n)</em> ou <em>head(n)</em> no resultado. Esses métodos também são oferecidos por <em>DataFrames</em> e é preciso informar a(s) coluna(s) desejada(s).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    4
1    5
2    2
3    3
4    9
5    7
6    8
7    0
8    1
9    6
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7    0
8    1
2    2
3    3
0    4
1    5
9    6
5    7
6    8
4    9
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7    0
8    1
2    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4    9
6    8
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                   <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abdceff&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-2</td>
      <td>a</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-1</td>
      <td>b</td>
      <td>2.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>d</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>10</td>
      <td>c</td>
      <td>3.2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>8</td>
      <td>e</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>5</td>
      <td>11</td>
      <td>f</td>
      <td>3.0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-1</td>
      <td>f</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
      <td>11</td>
      <td>f</td>
      <td>3.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>10</td>
      <td>c</td>
      <td>3.2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>8</td>
      <td>e</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-2</td>
      <td>a</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-1</td>
      <td>b</td>
      <td>2.0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-1</td>
      <td>f</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>d</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>8</td>
      <td>e</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="combinando-series-e-dataframes">
<h2><span class="section-number">3.3.4. </span>Combinando <em>Series</em> e <em>DataFrames</em><a class="headerlink" href="#combinando-series-e-dataframes" title="Permalink to this headline">¶</a></h2>
<p><em>Pandas</em> oferece diversas formas para combinar objetos <em>Series</em> e <em>DataFrames</em>, usando lógica de conjuntos para os índices e colunas e álgebra relacional para operações do tipo <em>join</em> (que remetem a operações de bancos de dados SQL).</p>
<p>A função <em>concat</em> faz o trabalho de concatenação ao longo de um eixo (<em>axis</em>), usando lógica de conjuntos (união ou interseção) dos índices ou colunas no outro eixo, se o outro eixo existir (<em>Series</em> tem apenas um eixo). Um exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
 

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;A7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="s1">&#39;D6&#39;</span><span class="p">,</span> <span class="s1">&#39;D7&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
 

<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="s1">&#39;A11&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span> <span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="s1">&#39;B11&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C8&#39;</span><span class="p">,</span> <span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="s1">&#39;C10&#39;</span><span class="p">,</span> <span class="s1">&#39;C11&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D8&#39;</span><span class="p">,</span> <span class="s1">&#39;D9&#39;</span><span class="p">,</span> <span class="s1">&#39;D10&#39;</span><span class="p">,</span> <span class="s1">&#39;D11&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>


<span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">]</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <td>5</td>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <td>6</td>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
    </tr>
    <tr>
      <td>9</td>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
    </tr>
    <tr>
      <td>10</td>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
    </tr>
    <tr>
      <td>11</td>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Suponha que você queira associar chaves específicas para os dados que pertenciam a cada <em>DataFrame</em> original. Para isso, pode-se usar o argumento <em>keys</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="4" valign="top">x</td>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td rowspan="4" valign="top">y</td>
      <td>4</td>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <td>5</td>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <td>6</td>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
    <tr>
      <td rowspan="4" valign="top">z</td>
      <td>8</td>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
    </tr>
    <tr>
      <td>9</td>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
    </tr>
    <tr>
      <td>10</td>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
    </tr>
    <tr>
      <td>11</td>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O mesmo efeito pode ser obtido passando um dicionário com as <em>DataFrames</em> parciais:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pieces</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">df1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">df2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">df3</span><span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>

<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="4" valign="top">x</td>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td rowspan="4" valign="top">y</td>
      <td>4</td>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <td>5</td>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <td>6</td>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
    <tr>
      <td rowspan="4" valign="top">z</td>
      <td>8</td>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
    </tr>
    <tr>
      <td>9</td>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
    </tr>
    <tr>
      <td>10</td>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
    </tr>
    <tr>
      <td>11</td>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O objeto resultante da concatenação passou a ter um índice múltiplo e hierárquico, o que permite selecionar cada bloco original usando o atributo <em>loc</em>. Note que no <em>jupyter notebook</em>, ao passar o ponteiro do <em>mouse</em> sobre um dos índices, as linhas que pertencem a ele são destacadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4</td>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <td>5</td>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <td>6</td>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenList([[&#39;x&#39;, &#39;y&#39;, &#39;z&#39;], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]])
</pre></div>
</div>
</div>
</div>
<p>O uso da função <em>concat</em> realiza uma cópia dos dados, então ela não deve ser usada iterativamente, i.e. se seus dados são gerados por um processo repetido, o ideal é guardar as <em>DataFrames</em> parciais em uma lista e aplicar <em>concat</em> uma única vez.</p>
<p>Ao juntar múltiplas <em>DataFrames</em>, é possível escolher como lidar com os outros eixos de duas formas usando o argumento <em>join</em>:</p>
<ol class="simple">
<li><p>Tomando a união, i.e. <em>join=’outer’</em>. Essa é a opção padrão e nunca resulta em perda de informação.</p></li>
<li><p>Tomando a interseção, i.e. <em>join=’inner’</em>.</p></li>
</ol>
<p>Primeiro vejamos um exemplo de <em>join=’outer’</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">,</span> <span class="s1">&#39;D6&#39;</span><span class="p">,</span> <span class="s1">&#39;D7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="s1">&#39;F3&#39;</span><span class="p">,</span> <span class="s1">&#39;F6&#39;</span><span class="p">,</span> <span class="s1">&#39;F7&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">df4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>B2</td>
      <td>D2</td>
      <td>F2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>B3</td>
      <td>D3</td>
      <td>F3</td>
    </tr>
    <tr>
      <td>6</td>
      <td>B6</td>
      <td>D6</td>
      <td>F6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>B7</td>
      <td>D7</td>
      <td>F7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>B</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>B2</td>
      <td>D2</td>
      <td>F2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>B3</td>
      <td>D3</td>
      <td>F3</td>
    </tr>
    <tr>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>B6</td>
      <td>D6</td>
      <td>F6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>B7</td>
      <td>D7</td>
      <td>F7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>NaN</td>
      <td>B2</td>
      <td>NaN</td>
      <td>D2</td>
      <td>F2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>NaN</td>
      <td>B3</td>
      <td>NaN</td>
      <td>D3</td>
      <td>F3</td>
    </tr>
    <tr>
      <td>6</td>
      <td>NaN</td>
      <td>B6</td>
      <td>NaN</td>
      <td>D6</td>
      <td>F6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>NaN</td>
      <td>B7</td>
      <td>NaN</td>
      <td>D7</td>
      <td>F7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>B</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>B2</td>
      <td>D2</td>
      <td>F2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>B3</td>
      <td>D3</td>
      <td>F3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>B0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>B1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>B2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>B3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td>2</td>
      <td>B2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>B3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td>6</td>
      <td>B6</td>
      <td>D6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>B7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para <em>DataFrames</em> que não possem índices importantes, é possível concatená-las e ignorar os índices originais, o que pode ser útil quando existem índices repetidos, como no exemplo acima. Para isso, usa-se o argumento <em>ignore_index</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>B0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>B1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>B2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>B3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>B2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>5</td>
      <td>B3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td>6</td>
      <td>B6</td>
      <td>D6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>B7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>B2</td>
      <td>D2</td>
      <td>F2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>B3</td>
      <td>D3</td>
      <td>F3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>É possível concatenar uma mistura de objetos <em>Series</em> e <em>DataFrame</em>. Internamente, <em>pandas</em> transforma a(s) <em>Series</em> em <em>DataFrame(s)</em> com apenas um coluna com o(s) mesmo(s) nome(s) da(s) <em>Series</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;X0&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>X</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>X0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>X1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>X2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>X3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Caso a(s) <em>Series</em> não tenha(m) nome, o(s) nome(s) será(ão) atribuído(s) numericamente e consecutivamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;_0&#39;</span><span class="p">,</span> <span class="s1">&#39;_1&#39;</span><span class="p">,</span> <span class="s1">&#39;_2&#39;</span><span class="p">,</span> <span class="s1">&#39;_3&#39;</span><span class="p">])</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>_0</td>
      <td>_0</td>
      <td>_0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>_1</td>
      <td>_1</td>
      <td>_1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>_2</td>
      <td>_2</td>
      <td>_2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>_3</td>
      <td>_3</td>
      <td>_3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>  <span class="c1"># todas as colunas perdem seus nomes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>X0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>X1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>X2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>X3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O argumento <em>keys</em> tem um uso interessante que é sobrescrever os nomes das colunas quando uma nova <em>DataFrame</em> é criada por meio da concatenação de várias <em>Series</em>. Note que o comportamento padrão, como vimos acima, é que a <em>DataFrame</em> resultante use o nome de cada <em>Series</em> como nome para a coluna resultante (caso a <em>Series</em> tenha nome).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>

<span class="n">s4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">s5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s3</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">s5</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s3</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">s5</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>red</th>
      <th>blue</th>
      <th>yellow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Mesmo não sendo muito eficiente (porque um novo objeto precisa ser criado), é possível adicionar um única linha nova a uma <em>DataFrame</em> passando uma <em>Series</em> para o método <em>append</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;X0&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td>t</td>
      <td>X0</td>
      <td>X1</td>
      <td>X2</td>
      <td>X3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Caso a <em>Series</em> não tenha nome, é necessário usar o argumento <em>ignore_index</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;X0&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>X0</td>
      <td>X1</td>
      <td>X2</td>
      <td>X3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="iterando-sobre-objetos">
<h2><span class="section-number">3.3.5. </span>Iterando sobre objetos<a class="headerlink" href="#iterando-sobre-objetos" title="Permalink to this headline">¶</a></h2>
<p>O comportamento de iteração em objetos <em>pandas</em> depende do tipo. Ao iterar sobre uma <em>Series</em>, o comportamento é igual a um <em>array</em> unidimensional, produzindo os seus valores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">s2</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X0
X1
X2
X3
</pre></div>
</div>
</div>
</div>
<p>No caso de <em>DataFrames</em>, <em>pandas</em> itera sobre as colunas, como se estivesse iterando sobre as chaves de um dicionário.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A
B
C
D
</pre></div>
</div>
</div>
</div>
<p>Para iterar sobre as linhas de uma <em>DataFrame</em>, <em>pandas</em> oferece os seguintes métodos: <em>iterrows()</em> e <em>itertuples()</em>. O método <em>iterrows()</em> retorna as linhas de uma <em>DataFrame</em> como pares (índice, <em>Series</em>). Como cada linha é retornada como uma <em>Series</em>, valores de colunas com tipos diferentes são convertidos para o tipo mais geral.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]})</span>

<span class="k">for</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row_index</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
a    1
b    a
Name: 0, dtype: object
1
a    2
b    b
Name: 1, dtype: object
2
a    3
b    c
Name: 2, dtype: object
</pre></div>
</div>
</div>
</div>
<p>O método <em>itertuples()</em>, por outro lado, retorna uma tupla nomeada para cada linha da <em>DataFrame</em>. O primeiro elemento da tupla será o índice e cada elemento seguinte corresponderá ao valor em cada coluna na linha. Caso o nome da coluna não possa ser convertido para um identificador Python válido, ele será substituído para um nome posicional. Se o número de colunas for maior do 255, tuplas comuns são retornadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pandas(Index=0, a=1, b=&#39;a&#39;)
Pandas(Index=1, a=2, b=&#39;b&#39;)
Pandas(Index=2, a=3, b=&#39;c&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]})</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pandas(Index=0, _1=1, _2=&#39;a&#39;)
Pandas(Index=1, _1=2, _2=&#39;b&#39;)
Pandas(Index=2, _1=3, _2=&#39;c&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dividindo-um-objeto-em-grupos">
<h2><span class="section-number">3.3.6. </span>Dividindo um objeto em grupos<a class="headerlink" href="#dividindo-um-objeto-em-grupos" title="Permalink to this headline">¶</a></h2>
<p>Objetos <em>pandas</em> podem ser divididos através de qualquer de seus eixos por meio de um mapeamento de valores para nomes de grupos. Essa operação cria um objeto do tipo <em>GroupBy</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;Falconiformes&#39;</span><span class="p">,</span> <span class="mf">389.0</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;Psittaciformes&#39;</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="s1">&#39;Carnivora&#39;</span><span class="p">,</span> <span class="mf">80.2</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="s1">&#39;Primates&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="s1">&#39;Carnivora&#39;</span><span class="p">,</span> <span class="mi">58</span><span class="p">)],</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;parrot&#39;</span><span class="p">,</span> <span class="s1">&#39;lion&#39;</span><span class="p">,</span> <span class="s1">&#39;monkey&#39;</span><span class="p">,</span> <span class="s1">&#39;leopard&#39;</span><span class="p">],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">,</span> <span class="s1">&#39;max_speed&#39;</span><span class="p">))</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>order</th>
      <th>max_speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>falcon</td>
      <td>bird</td>
      <td>Falconiformes</td>
      <td>389.0</td>
    </tr>
    <tr>
      <td>parrot</td>
      <td>bird</td>
      <td>Psittaciformes</td>
      <td>24.0</td>
    </tr>
    <tr>
      <td>lion</td>
      <td>mammal</td>
      <td>Carnivora</td>
      <td>80.2</td>
    </tr>
    <tr>
      <td>monkey</td>
      <td>mammal</td>
      <td>Primates</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>leopard</td>
      <td>mammal</td>
      <td>Carnivora</td>
      <td>58.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f669325ae10&gt;
</pre></div>
</div>
</div>
</div>
<p>Note que objetos do tipo <em>GroupBy</em> não têm comportamento definido de impressão. Eles existem para facilitar operações agrupadas. No entanto, é possível iterar sobre os diferentes grupos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name_of_the_group</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name_of_the_group</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bird
       class           order  max_speed
falcon  bird   Falconiformes      389.0
parrot  bird  Psittaciformes       24.0

mammal
          class      order  max_speed
lion     mammal  Carnivora       80.2
monkey   mammal   Primates        NaN
leopard  mammal  Carnivora       58.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">name_of_the_group</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name_of_the_group</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">name_of_the_group</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name_of_the_group</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;bird&#39;, &#39;Falconiformes&#39;)
       class          order  max_speed
falcon  bird  Falconiformes      389.0

(&#39;bird&#39;, &#39;Psittaciformes&#39;)
       class           order  max_speed
parrot  bird  Psittaciformes       24.0

(&#39;mammal&#39;, &#39;Carnivora&#39;)
          class      order  max_speed
lion     mammal  Carnivora       80.2
leopard  mammal  Carnivora       58.0

(&#39;mammal&#39;, &#39;Primates&#39;)
         class     order  max_speed
monkey  mammal  Primates        NaN
</pre></div>
</div>
</div>
</div>
<p>Por padrão, as chaves dos grupos são ordenadas para realizar o agrupamento, mas é possível desativar esse comportamento usando <em>sort=False</em> para aumentar a performance da operação.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Y</th>
    </tr>
    <tr>
      <th>X</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>7</td>
    </tr>
    <tr>
      <td>B</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Y</th>
    </tr>
    <tr>
      <th>X</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>B</td>
      <td>3</td>
    </tr>
    <tr>
      <td>A</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Apesar de ordenar as chaves dos grupos por padrão, o agrupamento mantém a ordem original das observações em cada grupo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>A</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>B</td>
      <td>4</td>
    </tr>
    <tr>
      <td>3</td>
      <td>B</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Uma vez que um objeto <em>GroupBy</em> é criado, é possível usá-lo para realizar diversas operações de agregação de forma bastante eficiente, usando os métodos <em>aggregate</em> e <em>agg</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arrays</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">]]</span>


<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">arrays</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">])</span>
    
    
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">)},</span>
                   <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>

<span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
    </tr>
    <tr>
      <th>A</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2</td>
      <td>9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">B</th>
    </tr>
    <tr>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>A</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>6</td>
      <td>1.5</td>
      <td>1.290994</td>
    </tr>
    <tr>
      <td>2</td>
      <td>9</td>
      <td>4.5</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <td>3</td>
      <td>13</td>
      <td>6.5</td>
      <td>0.707107</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Outra operação agregada simples pode ser feita usando o método <em>size</em> que retorna a quantidade de elementos em cada grupo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A
1    4
2    2
3    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>É possível controlar o nome das colunas resultantes das operações de agregação por meio de um sintaxe especial no método <em>agg()</em>, chamada de agregação nomeada. Nesse caso, os argumentos serão os nomes das colunas resultantes e os valores dos argumentos serão tuplas, cujo primeiro elemento é a coluna a ser agregada e o segunda é a função de agregação a ser aplicada. A função de agregação pode ser passada como <em>string</em> ou pelo seu nome (e també pode ter sido criada pelo usuário).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">animals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">9.1</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mf">34.0</span><span class="p">],</span>
                        <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">7.9</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">9.9</span><span class="p">,</span> <span class="mf">198.0</span><span class="p">]})</span>




<span class="n">animals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;kind&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">min_height</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">max_height</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">average_weight</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_height</th>
      <th>max_height</th>
      <th>average_weight</th>
    </tr>
    <tr>
      <th>kind</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cat</td>
      <td>9.1</td>
      <td>9.5</td>
      <td>8.90</td>
    </tr>
    <tr>
      <td>dog</td>
      <td>6.0</td>
      <td>34.0</td>
      <td>102.75</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="lendo-e-escrevendo-dados">
<h2><span class="section-number">3.3.7. </span>Lendo e escrevendo dados<a class="headerlink" href="#lendo-e-escrevendo-dados" title="Permalink to this headline">¶</a></h2>
<p><em>Pandas</em> consegue ler e escrever arquivos de diversos tipos, incluindo <em>csv</em>, <em>excel</em>, <em>json</em>, <em>HDF5</em>, <em>SAS</em>, <em>SPSS</em> e outros. Os tipos disponíveis podem ser visualizados na <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">documentação de entrada e saída</a>. De uma maneira geral, as funções de leitura tem assinatura <em>read_tipo</em>, e.g. <em>read_csv</em>, e podem ler arquivos locais ou remotos, enquanto os métodos de escrita tem assinatura <em>to_tipo</em>, e.g. <em>to_csv</em>. O código abaixo lê um arquivo <em>csv</em> hospedado em um repositório do <em>Github</em> e calcula as correlações entre as colunas. O parâmetro <em>index_col</em> indica qual coluna do arquivo <em>csv</em> deve ser usada como índice da tabela. Por padrão, supõe-se que cada coluna de um arquivo <em>csv</em> é separada por vírgulas. Isso pode ser modificado por meio do parâmetro <em>sep</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://tmfilho.github.io/pyestbook/data/google-trends-timeline.csv&#39;</span>
<span class="n">trends</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="n">trends</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Python</th>
      <th>R</th>
      <th>Machine learning</th>
      <th>Data science</th>
    </tr>
    <tr>
      <th>Week</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2014-10-05</td>
      <td>37</td>
      <td>24</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2014-10-12</td>
      <td>37</td>
      <td>24</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2014-10-19</td>
      <td>38</td>
      <td>24</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2014-10-26</td>
      <td>37</td>
      <td>24</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2014-11-02</td>
      <td>38</td>
      <td>23</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2019-08-25</td>
      <td>88</td>
      <td>22</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2019-09-01</td>
      <td>90</td>
      <td>22</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2019-09-08</td>
      <td>97</td>
      <td>24</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2019-09-15</td>
      <td>100</td>
      <td>25</td>
      <td>8</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2019-09-22</td>
      <td>100</td>
      <td>25</td>
      <td>8</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>260 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trends</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">)</span>  <span class="c1"># method é opcional</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Python</th>
      <th>R</th>
      <th>Machine learning</th>
      <th>Data science</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Python</td>
      <td>1.000000</td>
      <td>0.369220</td>
      <td>0.964809</td>
      <td>0.967090</td>
    </tr>
    <tr>
      <td>R</td>
      <td>0.369220</td>
      <td>1.000000</td>
      <td>0.287584</td>
      <td>0.254663</td>
    </tr>
    <tr>
      <td>Machine learning</td>
      <td>0.964809</td>
      <td>0.287584</td>
      <td>1.000000</td>
      <td>0.961119</td>
    </tr>
    <tr>
      <td>Data science</td>
      <td>0.967090</td>
      <td>0.254663</td>
      <td>0.961119</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Os dados lidos são compostos por séries temporais com 260 observações, que representam o interesse mundial por quatro tópicos de buscas no Google: Python, R, aprendizagem de máquina e ciência de dados. A quantidade de buscas de cada tópico foi medida semanalmente. O argumento <em>parse_dates</em> indica que as datas no índice da <em>DataFrame</em> devem ser tratadas como objetos <em>datetime</em>, não como <em>strings</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trends</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2014-10-05&#39;, &#39;2014-10-12&#39;, &#39;2014-10-19&#39;, &#39;2014-10-26&#39;,
               &#39;2014-11-02&#39;, &#39;2014-11-09&#39;, &#39;2014-11-16&#39;, &#39;2014-11-23&#39;,
               &#39;2014-11-30&#39;, &#39;2014-12-07&#39;,
               ...
               &#39;2019-07-21&#39;, &#39;2019-07-28&#39;, &#39;2019-08-04&#39;, &#39;2019-08-11&#39;,
               &#39;2019-08-18&#39;, &#39;2019-08-25&#39;, &#39;2019-09-01&#39;, &#39;2019-09-08&#39;,
               &#39;2019-09-15&#39;, &#39;2019-09-22&#39;],
              dtype=&#39;datetime64[ns]&#39;, name=&#39;Week&#39;, length=260, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trends</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
</div>
</div>
<p>O argumento <em>parse_dates</em> pode receber diferentes valores, tendo comportamentos diferentes:</p>
<ol class="simple">
<li><p>boolean: Se True -&gt; tentar tratar o índice;</p></li>
<li><p>list de inteiros ou nomes: Se [1, 2, 3] -&gt; tentar tratar colunas 1, 2 e 3 como colunas separadas de datas;</p></li>
<li><p>list de lists: Se [[1, 3]] -&gt; combinar colunas 1 e 3 e tratar como uma única coluna de datas;</p></li>
<li><p>dict: Se {‘foo’ : [1, 3]} -&gt; tratar colunas 1 e 3 como datas e chamar a coluna resultante de <em>foo</em>.</p></li>
</ol>
<p>Se uma das colunas especificadas ou um índice possuir um valor não tratável ou uma mistura de fusos horários, seus valores serão retornados não-tratados com tipo <em>object</em>.</p>
<p>Para escrever uma <em>DataFrame</em> em um arquivo <em>csv</em>, pode-se usar o método <em>to_csv</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trends</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;google-trends-timeline.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Se nenhum diretório for especificado, a <em>DataFrame</em> será escrita em um arquivo com o nome informado, localizado no mesmo diretório do <em>script</em> <em>Python</em> que chamou o método. Caso o método tenha sido chamado em um <em>script</em> interno de um projeto, o arquivo será salvo no mesmo diretório do <em>script</em> que contém o <em>main</em>.</p>
</div>
<div class="section" id="tabelas-pivotadas">
<h2><span class="section-number">3.3.8. </span>Tabelas pivotadas<a class="headerlink" href="#tabelas-pivotadas" title="Permalink to this headline">¶</a></h2>
<p><em>Pandas</em> fornece a função <em>pivot_table()</em> para pivotar tabelas agregando dados numéricos. A ação de pivotar envolve um agrupamento (<em>GroupBy</em>) seguido da aplicação de função(ões) de agregação. A função <em>pivot_table()</em> recebe os seguintes argumentos:</p>
<ol class="simple">
<li><p>data: uma <em>DataFrame</em>.</p></li>
<li><p>values: uma coluna ou lista de colunas cujos valores serão agregados.</p></li>
<li><p>index: coluna(s), um objeto do tipo <em>Grouper</em> ou <em>array</em> que será usado como índice para as linhas da tabela resultante.</p></li>
<li><p>columns: coluna(s), um objeto do tipo <em>Grouper</em> ou <em>array</em> que define as colunas da tabela resultante.</p></li>
<li><p>aggfunc: função(ões) para realizar a agregação, com <em>numpy.mean</em> por padrão.</p></li>
</ol>
<p>Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
                   <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span>
                   <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span>
                   <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>
                   <span class="o">+</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]})</span>


<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>one</td>
      <td>A</td>
      <td>foo</td>
      <td>-0.355909</td>
      <td>0.744463</td>
      <td>2013-01-01</td>
    </tr>
    <tr>
      <td>1</td>
      <td>one</td>
      <td>B</td>
      <td>foo</td>
      <td>0.052146</td>
      <td>0.775242</td>
      <td>2013-02-01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>two</td>
      <td>C</td>
      <td>foo</td>
      <td>-0.784270</td>
      <td>2.334583</td>
      <td>2013-03-01</td>
    </tr>
    <tr>
      <td>3</td>
      <td>three</td>
      <td>A</td>
      <td>bar</td>
      <td>-0.245455</td>
      <td>0.470639</td>
      <td>2013-04-01</td>
    </tr>
    <tr>
      <td>4</td>
      <td>one</td>
      <td>B</td>
      <td>bar</td>
      <td>-0.029052</td>
      <td>-1.925866</td>
      <td>2013-05-01</td>
    </tr>
    <tr>
      <td>5</td>
      <td>one</td>
      <td>C</td>
      <td>bar</td>
      <td>1.217396</td>
      <td>-1.085589</td>
      <td>2013-06-01</td>
    </tr>
    <tr>
      <td>6</td>
      <td>two</td>
      <td>A</td>
      <td>foo</td>
      <td>-2.240222</td>
      <td>-2.641271</td>
      <td>2013-07-01</td>
    </tr>
    <tr>
      <td>7</td>
      <td>three</td>
      <td>B</td>
      <td>foo</td>
      <td>0.940340</td>
      <td>0.248422</td>
      <td>2013-08-01</td>
    </tr>
    <tr>
      <td>8</td>
      <td>one</td>
      <td>C</td>
      <td>foo</td>
      <td>-0.642764</td>
      <td>-1.250607</td>
      <td>2013-09-01</td>
    </tr>
    <tr>
      <td>9</td>
      <td>one</td>
      <td>A</td>
      <td>bar</td>
      <td>0.131560</td>
      <td>0.971875</td>
      <td>2013-10-01</td>
    </tr>
    <tr>
      <td>10</td>
      <td>two</td>
      <td>B</td>
      <td>bar</td>
      <td>0.834734</td>
      <td>-0.491606</td>
      <td>2013-11-01</td>
    </tr>
    <tr>
      <td>11</td>
      <td>three</td>
      <td>C</td>
      <td>bar</td>
      <td>-0.058913</td>
      <td>-0.295954</td>
      <td>2013-12-01</td>
    </tr>
    <tr>
      <td>12</td>
      <td>one</td>
      <td>A</td>
      <td>foo</td>
      <td>-0.550949</td>
      <td>-0.629001</td>
      <td>2013-01-15</td>
    </tr>
    <tr>
      <td>13</td>
      <td>one</td>
      <td>B</td>
      <td>foo</td>
      <td>1.411367</td>
      <td>-0.117684</td>
      <td>2013-02-15</td>
    </tr>
    <tr>
      <td>14</td>
      <td>two</td>
      <td>C</td>
      <td>foo</td>
      <td>-0.749043</td>
      <td>-2.495172</td>
      <td>2013-03-15</td>
    </tr>
    <tr>
      <td>15</td>
      <td>three</td>
      <td>A</td>
      <td>bar</td>
      <td>-1.861024</td>
      <td>-1.254382</td>
      <td>2013-04-15</td>
    </tr>
    <tr>
      <td>16</td>
      <td>one</td>
      <td>B</td>
      <td>bar</td>
      <td>2.156923</td>
      <td>-2.533298</td>
      <td>2013-05-15</td>
    </tr>
    <tr>
      <td>17</td>
      <td>one</td>
      <td>C</td>
      <td>bar</td>
      <td>0.822397</td>
      <td>-0.610182</td>
      <td>2013-06-15</td>
    </tr>
    <tr>
      <td>18</td>
      <td>two</td>
      <td>A</td>
      <td>foo</td>
      <td>-0.343756</td>
      <td>0.546581</td>
      <td>2013-07-15</td>
    </tr>
    <tr>
      <td>19</td>
      <td>three</td>
      <td>B</td>
      <td>foo</td>
      <td>0.181326</td>
      <td>-0.177252</td>
      <td>2013-08-15</td>
    </tr>
    <tr>
      <td>20</td>
      <td>one</td>
      <td>C</td>
      <td>foo</td>
      <td>0.540137</td>
      <td>-1.204380</td>
      <td>2013-09-15</td>
    </tr>
    <tr>
      <td>21</td>
      <td>one</td>
      <td>A</td>
      <td>bar</td>
      <td>0.923445</td>
      <td>-0.849469</td>
      <td>2013-10-15</td>
    </tr>
    <tr>
      <td>22</td>
      <td>two</td>
      <td>B</td>
      <td>bar</td>
      <td>0.215326</td>
      <td>-0.699474</td>
      <td>2013-11-15</td>
    </tr>
    <tr>
      <td>23</td>
      <td>three</td>
      <td>C</td>
      <td>bar</td>
      <td>-0.545537</td>
      <td>0.349322</td>
      <td>2013-12-15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> 
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3" valign="top">one</td>
      <td>A</td>
      <td>0.527503</td>
      <td>-0.453429</td>
    </tr>
    <tr>
      <td>B</td>
      <td>1.063935</td>
      <td>0.731756</td>
    </tr>
    <tr>
      <td>C</td>
      <td>1.019897</td>
      <td>-0.051313</td>
    </tr>
    <tr>
      <td rowspan="3" valign="top">three</td>
      <td>A</td>
      <td>-1.053239</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>B</td>
      <td>NaN</td>
      <td>0.560833</td>
    </tr>
    <tr>
      <td>C</td>
      <td>-0.302225</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td rowspan="3" valign="top">two</td>
      <td>A</td>
      <td>NaN</td>
      <td>-1.291989</td>
    </tr>
    <tr>
      <td>B</td>
      <td>0.525030</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>C</td>
      <td>NaN</td>
      <td>-0.766656</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> 
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> 
    <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>A</th>
      <th colspan="2" halign="left">one</th>
      <th colspan="2" halign="left">three</th>
      <th colspan="2" halign="left">two</th>
    </tr>
    <tr>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>B</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>1.055005</td>
      <td>-0.906858</td>
      <td>-2.106479</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.583979</td>
    </tr>
    <tr>
      <td>B</td>
      <td>2.127871</td>
      <td>1.463513</td>
      <td>NaN</td>
      <td>1.121665</td>
      <td>1.05006</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>C</td>
      <td>2.039793</td>
      <td>-0.102627</td>
      <td>-0.604450</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.533313</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">],</span> 
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> 
    <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">D</th>
      <th colspan="6" halign="left">E</th>
    </tr>
    <tr>
      <th>A</th>
      <th colspan="2" halign="left">one</th>
      <th colspan="2" halign="left">three</th>
      <th colspan="2" halign="left">two</th>
      <th colspan="2" halign="left">one</th>
      <th colspan="2" halign="left">three</th>
      <th colspan="2" halign="left">two</th>
    </tr>
    <tr>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>B</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>1.055005</td>
      <td>-0.906858</td>
      <td>-2.106479</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.583979</td>
      <td>0.122406</td>
      <td>0.115462</td>
      <td>-0.783743</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.094690</td>
    </tr>
    <tr>
      <td>B</td>
      <td>2.127871</td>
      <td>1.463513</td>
      <td>NaN</td>
      <td>1.121665</td>
      <td>1.05006</td>
      <td>NaN</td>
      <td>-4.459164</td>
      <td>0.657558</td>
      <td>NaN</td>
      <td>0.07117</td>
      <td>-1.19108</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>C</td>
      <td>2.039793</td>
      <td>-0.102627</td>
      <td>-0.604450</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.533313</td>
      <td>-1.695771</td>
      <td>-2.454986</td>
      <td>0.053368</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.160589</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O objeto resultante é uma <em>DataFrame</em> com índices e colunas potencialmente hieráquicos. Se o argumento <em>values</em> não for especificado, a tabela pivotada irá conter todas as colunas que podem ser agregadas em um nível adicional de hierarquia nas colunas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">D</th>
      <th colspan="2" halign="left">E</th>
    </tr>
    <tr>
      <th></th>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3" valign="top">one</td>
      <td>A</td>
      <td>0.527503</td>
      <td>-0.453429</td>
      <td>0.061203</td>
      <td>0.057731</td>
    </tr>
    <tr>
      <td>B</td>
      <td>1.063935</td>
      <td>0.731756</td>
      <td>-2.229582</td>
      <td>0.328779</td>
    </tr>
    <tr>
      <td>C</td>
      <td>1.019897</td>
      <td>-0.051313</td>
      <td>-0.847885</td>
      <td>-1.227493</td>
    </tr>
    <tr>
      <td rowspan="3" valign="top">three</td>
      <td>A</td>
      <td>-1.053239</td>
      <td>NaN</td>
      <td>-0.391871</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>B</td>
      <td>NaN</td>
      <td>0.560833</td>
      <td>NaN</td>
      <td>0.035585</td>
    </tr>
    <tr>
      <td>C</td>
      <td>-0.302225</td>
      <td>NaN</td>
      <td>0.026684</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td rowspan="3" valign="top">two</td>
      <td>A</td>
      <td>NaN</td>
      <td>-1.291989</td>
      <td>NaN</td>
      <td>-1.047345</td>
    </tr>
    <tr>
      <td>B</td>
      <td>0.525030</td>
      <td>NaN</td>
      <td>-0.595540</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>C</td>
      <td>NaN</td>
      <td>-0.766656</td>
      <td>NaN</td>
      <td>-0.080295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Um objeto <em>Grouper</em> pode ser usado para os argumentos <em>index</em> e <em>columns</em>. No código abaixo, <em>Grouper</em> é usado para definir um agrupamento mensal das datas da coluna <em>‘F’</em>. Para mais possibilidades de frequência e agrupamento, ver a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases">documentação de Grouper</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> 
    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">),</span>
    <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;C&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>F</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2013-01-31</td>
      <td>NaN</td>
      <td>-0.453429</td>
    </tr>
    <tr>
      <td>2013-02-28</td>
      <td>NaN</td>
      <td>0.731756</td>
    </tr>
    <tr>
      <td>2013-03-31</td>
      <td>NaN</td>
      <td>-0.766656</td>
    </tr>
    <tr>
      <td>2013-04-30</td>
      <td>-1.053239</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2013-05-31</td>
      <td>1.063935</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2013-06-30</td>
      <td>1.019897</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2013-07-31</td>
      <td>NaN</td>
      <td>-1.291989</td>
    </tr>
    <tr>
      <td>2013-08-31</td>
      <td>NaN</td>
      <td>0.560833</td>
    </tr>
    <tr>
      <td>2013-09-30</td>
      <td>NaN</td>
      <td>-0.051313</td>
    </tr>
    <tr>
      <td>2013-10-31</td>
      <td>0.527503</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2013-11-30</td>
      <td>0.525030</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2013-12-31</td>
      <td>-0.302225</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para imprimir a tabela resultante usando uma representação mais interessante para os dados faltantes, pode-se usar o método <em>to_string</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">na_rep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                D                   E          
C             bar       foo       bar       foo
A     B                                        
one   A  0.527503 -0.453429  0.061203  0.057731
      B  1.063935  0.731756 -2.229582  0.328779
      C  1.019897 -0.051313 -0.847885 -1.227493
three A -1.053239           -0.391871          
      B            0.560833            0.035585
      C -0.302225            0.026684          
two   A           -1.291989           -1.047345
      B  0.525030           -0.595540          
      C           -0.766656           -0.080295
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">na_rep</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                D                   E          
C             bar       foo       bar       foo
A     B                                        
one   A  0.527503 -0.453429  0.061203  0.057731
      B  1.063935  0.731756 -2.229582  0.328779
      C  1.019897 -0.051313 -0.847885 -1.227493
three A -1.053239         X -0.391871         X
      B         X  0.560833         X  0.035585
      C -0.302225         X  0.026684         X
two   A         X -1.291989         X -1.047345
      B  0.525030         X -0.595540         X
      C         X -0.766656         X -0.080295
</pre></div>
</div>
</div>
</div>
<p>A função <em>pivot_table()</em> é frequentemente usada para agregar resultados de experimentos. Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;cross-entropy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;LR&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;DT&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;SVM&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;NB&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>accuracy</th>
      <th>cross-entropy</th>
      <th>method</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.058021</td>
      <td>3.673022</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.684558</td>
      <td>3.903397</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.861547</td>
      <td>4.631766</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.503128</td>
      <td>2.819378</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.465918</td>
      <td>3.441359</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.983185</td>
      <td>2.336337</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.467017</td>
      <td>2.048949</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.063816</td>
      <td>0.235962</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.108218</td>
      <td>1.984114</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.440994</td>
      <td>3.385187</td>
      <td>LR</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.863484</td>
      <td>1.134891</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.420522</td>
      <td>2.434326</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.749450</td>
      <td>4.635274</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.845294</td>
      <td>0.133899</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.148835</td>
      <td>1.649759</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.695900</td>
      <td>4.472928</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.954822</td>
      <td>1.974228</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.687887</td>
      <td>4.625070</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.386464</td>
      <td>2.644813</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.866231</td>
      <td>2.011877</td>
      <td>DT</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.163856</td>
      <td>4.086992</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.817507</td>
      <td>3.860379</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.173703</td>
      <td>3.657058</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.207760</td>
      <td>2.107466</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.611686</td>
      <td>3.093881</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.496356</td>
      <td>1.803371</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.531771</td>
      <td>2.416171</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.401664</td>
      <td>0.390018</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.651415</td>
      <td>0.532025</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.425486</td>
      <td>4.031853</td>
      <td>SVM</td>
    </tr>
    <tr>
      <td>30</td>
      <td>0.166310</td>
      <td>3.113929</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>31</td>
      <td>0.081851</td>
      <td>0.334993</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>32</td>
      <td>0.265789</td>
      <td>4.895663</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>33</td>
      <td>0.795316</td>
      <td>3.737901</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>34</td>
      <td>0.833041</td>
      <td>3.936752</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>35</td>
      <td>0.158680</td>
      <td>4.767437</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>36</td>
      <td>0.829785</td>
      <td>4.506563</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>37</td>
      <td>0.047468</td>
      <td>4.198186</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>38</td>
      <td>0.110024</td>
      <td>4.263557</td>
      <td>NB</td>
    </tr>
    <tr>
      <td>39</td>
      <td>0.204987</td>
      <td>1.187426</td>
      <td>NB</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;cross-entropy&#39;</span><span class="p">],</span> 
    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;method&#39;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mean</th>
      <th colspan="2" halign="left">std</th>
    </tr>
    <tr>
      <th></th>
      <th>accuracy</th>
      <th>cross-entropy</th>
      <th>accuracy</th>
      <th>cross-entropy</th>
    </tr>
    <tr>
      <th>method</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>DT</td>
      <td>0.661889</td>
      <td>2.571706</td>
      <td>0.260061</td>
      <td>1.550670</td>
    </tr>
    <tr>
      <td>LR</td>
      <td>0.463640</td>
      <td>2.845947</td>
      <td>0.321431</td>
      <td>1.251092</td>
    </tr>
    <tr>
      <td>NB</td>
      <td>0.349325</td>
      <td>3.494241</td>
      <td>0.330203</td>
      <td>1.541978</td>
    </tr>
    <tr>
      <td>SVM</td>
      <td>0.448120</td>
      <td>2.597921</td>
      <td>0.218685</td>
      <td>1.385749</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Após a geração da tabela pivotada com os resultados, pode-se gerar a tabela em formato de código <em>LaTeX</em>, para inclusão em artigos e relatórios:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">to_latex</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;\\begin{tabular}{lrrrr}\n\\toprule\n{} &amp; \\multicolumn{2}{l}{mean} &amp; \\multicolumn{2}{l}{std} \\\\\n{} &amp;  accuracy &amp; cross-entropy &amp;  accuracy &amp; cross-entropy \\\\\nmethod &amp;           &amp;               &amp;           &amp;               \\\\\n\\midrule\nDT     &amp;  0.661889 &amp;      2.571706 &amp;  0.260061 &amp;      1.550670 \\\\\nLR     &amp;  0.463640 &amp;      2.845947 &amp;  0.321431 &amp;      1.251092 \\\\\nNB     &amp;  0.349325 &amp;      3.494241 &amp;  0.330203 &amp;      1.541978 \\\\\nSVM    &amp;  0.448120 &amp;      2.597921 &amp;  0.218685 &amp;      1.385749 \\\\\n\\bottomrule\n\\end{tabular}\n&#39;
</pre></div>
</div>
</div>
</div>
<p>O retorno de <em>to_latex()</em> inclui barras duplas e quebras de linhas com <em>\n</em> pois elas são necessárias para retornar barras dentro de <em>strings</em> Python.</p>
<p>\begin{tabular}{lrrrr}
\toprule
{} &amp; \multicolumn{2}{l}{mean} &amp; \multicolumn{2}{l}{std} \
{} &amp;  accuracy &amp; cross-entropy &amp;  accuracy &amp; cross-entropy \
method &amp;           &amp;               &amp;           &amp;               \
\midrule
DT     &amp;  0.365762 &amp;      2.227704 &amp;  0.326730 &amp;      1.327534 \
LR     &amp;  0.314544 &amp;      2.995433 &amp;  0.250636 &amp;      1.146052 \
NB     &amp;  0.439088 &amp;      2.596552 &amp;  0.286103 &amp;      1.748327 \
SVM    &amp;  0.631967 &amp;      2.153559 &amp;  0.296118 &amp;      1.059571 \
\bottomrule
\end{tabular}</p>
</div>
<div class="section" id="reindexando-e-alterando-rotulos">
<h2><span class="section-number">3.3.9. </span>Reindexando e alterando rótulos<a class="headerlink" href="#reindexando-e-alterando-rotulos" title="Permalink to this headline">¶</a></h2>
<p>Suponha que você tem dados provenientes de fontes diferentes. As tabelas tem colunhas e linhas em comum e outras diferentes. Você quer trabalhar com os dados em comum, e preencher os valores faltantes de alguma forma. Além disso, você quer que os dados estejam dispostos em uma ordenação específica através dos índices e das colunas. Tudo isso pode ser realizado por meio do método <em>reindex()</em>, que é a forma principal de “realinhar” dados em <em>pandas</em>. Reindexar significa ajustar os dados a um dado conjuntode rótulos através de um eixo. Isso permite reordenar os dados existentes, inserir posições faltantes onde não existem dados para os rótulos passados e preencher esses dados faltantes. Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> 
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a   -1.205372
b   -0.739105
c   -0.273853
d    0.803507
e   -0.258411
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e   -0.258411
b   -0.739105
f         NaN
d    0.803507
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Note que o rótulo ‘f’ não estava presente na <em>Series</em>, aparecendo como <em>NaN</em> no resultado. No caso de <em>DataFrames</em>, é possível reindexar índices e colunas simultaneamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="p">})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-2.087604</td>
      <td>0.639633</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.482247</td>
      <td>-0.864124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>three</th>
      <th>two</th>
      <th>one</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>c</td>
      <td>1.220307</td>
      <td>-0.086431</td>
      <td>-0.006408</td>
    </tr>
    <tr>
      <td>f</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.804665</td>
      <td>0.722227</td>
      <td>-0.511575</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O método <em>reindex()</em> também pode ser usado com o argumento <em>axis</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>f</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c</th>
      <th>f</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>c</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>three</th>
      <th>two</th>
      <th>one</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>NaN</td>
      <td>0.639633</td>
      <td>-2.087604</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.804665</td>
      <td>0.722227</td>
      <td>-0.511575</td>
    </tr>
    <tr>
      <td>c</td>
      <td>1.220307</td>
      <td>-0.086431</td>
      <td>-0.006408</td>
    </tr>
    <tr>
      <td>d</td>
      <td>-0.864124</td>
      <td>-1.482247</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>three</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>two</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>one</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Objetos do tipo <em>Index</em> podem ser compartilhados entre objetos <em>Series</em> e <em>DataFrame</em> por meio do método <em>reindex</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rs</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">rs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a   -1.205372
b   -0.739105
c   -0.273853
d    0.803507
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rs</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Para reindexar um objeto, de forma que ele fique perfeitamente “alinhado” com outro, pode-se usar o “atalho” <em>reindex_like()</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-2.087604</td>
      <td>0.639633</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.482247</td>
      <td>-0.864124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
<span class="p">})</span>

<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>two</th>
      <th>one</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>0.519589</td>
      <td>1.492297</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.193824</td>
      <td>-1.522476</td>
    </tr>
    <tr>
      <td>c</td>
      <td>0.339242</td>
      <td>0.220409</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>two</th>
      <th>one</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>0.639633</td>
      <td>-2.087604</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.722227</td>
      <td>-0.511575</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.086431</td>
      <td>-0.006408</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A operação de reindexação torna-se mais importante quando é necessário escrever códigos cujo desempenho é fator essencial. Diversas operações são realizadas mais rapidamente sobre dados pré-alinhados, como as operações aritméticas, que precisam disparar um realinhamento interno, se os dados não estiverem alinhados.</p>
<p>Caso seja interessante alinhar dois objeto simultaneamente, pode-se usar o método <em>align</em> (ao invés de duas chamadas ao método <em>reindex</em>). O método <em>align</em> retorna uma tupla com os dois objetos realinhados e aceita o argumento <em>join</em> para indicar a forma como os objetos serão alinhados:</p>
<ol class="simple">
<li><p>join=’outer’: toma a união dos índices (default);</p></li>
<li><p>join=’left’: usa o índice do objeto que chama o método;</p></li>
<li><p>join=’right’: usa o índice do objeto passado como parâmetro;</p></li>
<li><p>join=’inner’: toma a interseção do síndices.</p></li>
</ol>
<p>Exemplos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> 
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">s1</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(a   -1.395306
 b    0.823696
 c   -0.131460
 d   -1.139574
 e         NaN
 dtype: float64,
 a         NaN
 b    0.823696
 c   -0.131460
 d   -1.139574
 e   -1.670965
 dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(b    0.823696
 c   -0.131460
 d   -1.139574
 dtype: float64,
 b    0.823696
 c   -0.131460
 d   -1.139574
 dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(a   -1.395306
 b    0.823696
 c   -0.131460
 d   -1.139574
 dtype: float64,
 a         NaN
 b    0.823696
 c   -0.131460
 d   -1.139574
 dtype: float64)
</pre></div>
</div>
</div>
</div>
<p>Para <em>DataFrames</em>, o <em>join</em> é aplicado aos índices e às colunas por padrão:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-2.087604</td>
      <td>0.639633</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.482247</td>
      <td>-0.864124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>two</th>
      <th>one</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>0.519589</td>
      <td>1.492297</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.193824</td>
      <td>-1.522476</td>
    </tr>
    <tr>
      <td>c</td>
      <td>0.339242</td>
      <td>0.220409</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(        one       two
 a -2.087604  0.639633
 b -0.511575  0.722227
 c -0.006408 -0.086431,
         one       two
 a  1.492297  0.519589
 b -1.522476 -0.193824
 c  0.220409  0.339242)
</pre></div>
</div>
</div>
</div>
<p>Usando o argumento <em>axis</em>, é possível especificar a qual eixo o <em>join</em> deve ser aplicado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(        one       two     three
 a -2.087604  0.639633       NaN
 b -0.511575  0.722227 -0.804665
 c -0.006408 -0.086431  1.220307,
         two       one
 a  0.519589  1.492297
 b -0.193824 -1.522476
 c  0.339242  0.220409)
</pre></div>
</div>
</div>
</div>
<p>Ao passar uma <em>Series</em> ao método <em>align</em> de uma <em>DataFrame</em>,é possível escolher alinhas ambos os objetos de acordo com o índice ou com as colunas da <em>DataFrame</em>, usando o argumento <em>axis</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(        one     three       two
 a -2.087604       NaN  0.639633
 b -0.511575 -0.804665  0.722227
 c -0.006408  1.220307 -0.086431
 d       NaN -0.864124 -1.482247,
 one      1.492297
 three         NaN
 two      0.519589
 Name: a, dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="section" id="preenchendo-valores-faltantes">
<h3><span class="section-number">3.3.9.1. </span>Preenchendo valores faltantes<a class="headerlink" href="#preenchendo-valores-faltantes" title="Permalink to this headline">¶</a></h3>
<p>O método <em>reindex</em> pode receber um parâmetro opcional que determina uma forma de preencher dados faltantes. Os valores possíveis para esse argumento são:</p>
<ol class="simple">
<li><p>pad/ffill: preenche os valores para a frente;</p></li>
<li><p>bfill/backfill: preenche os valores para trás;</p></li>
<li><p>nearest: preenche com os valores do índice mais próximo.</p></li>
</ol>
<p>Exemplos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/3/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="n">ts2</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>

<span class="n">ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04    0.236978
2000-01-05   -0.343987
2000-01-06    0.153883
2000-01-07    0.318132
2000-01-08    3.196918
2000-01-09   -1.184264
2000-01-10    0.344937
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-06    0.153883
2000-01-09   -1.184264
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04         NaN
2000-01-05         NaN
2000-01-06    0.153883
2000-01-07         NaN
2000-01-08         NaN
2000-01-09   -1.184264
2000-01-10         NaN
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04    2.671480
2000-01-05    2.671480
2000-01-06    0.153883
2000-01-07    0.153883
2000-01-08    0.153883
2000-01-09   -1.184264
2000-01-10   -1.184264
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04    0.153883
2000-01-05    0.153883
2000-01-06    0.153883
2000-01-07   -1.184264
2000-01-08   -1.184264
2000-01-09   -1.184264
2000-01-10         NaN
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04    2.671480
2000-01-05    0.153883
2000-01-06    0.153883
2000-01-07    0.153883
2000-01-08   -1.184264
2000-01-09   -1.184264
2000-01-10   -1.184264
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Note que esses métodos de preenchimento precisam que os índices estejam ordenados (em ordem ascendente ou decrescente). Caso seja desejável limitar o preenchimento de dados faltantes, para evitar que valores muito distantes sejam usados, pode-se usar os argumentos <em>limit</em> e <em>tolerance</em>. <em>Limit</em> especifica o número máximo de preenchimentos consecutivos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04    2.671480
2000-01-05         NaN
2000-01-06    0.153883
2000-01-07    0.153883
2000-01-08         NaN
2000-01-09   -1.184264
2000-01-10   -1.184264
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<p><em>Tolerance</em> especifica o intervalo máximo entre o índice faltante e o índice que será usado para preenchê-lo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="s1">&#39;1 day&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04    2.671480
2000-01-05         NaN
2000-01-06    0.153883
2000-01-07    0.153883
2000-01-08         NaN
2000-01-09   -1.184264
2000-01-10   -1.184264
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Resultados parecidos de preenchimento podem ser obtidos pelo método <em>fillna</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03    2.671480
2000-01-04    2.671480
2000-01-05    2.671480
2000-01-06    0.153883
2000-01-07    0.153883
2000-01-08    0.153883
2000-01-09   -1.184264
2000-01-10   -1.184264
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>O método <em>fillna</em> pode ser bastante útil por permitir o preenchimento usando um objeto <em>pandas</em> ou um dicionário que seja alinhável, ou seja, as chaves do dicionário ou índice da <em>Series</em> precisam se ajustar às colunas da <em>DataFrame</em> que será preenchida. Um caso de uso muito comum para isso é preencher dados faltantes com a média ou a mediana das colunas correspondentes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">))</span>

<span class="n">dff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">dff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">dff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">dff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.475864</td>
      <td>0.641042</td>
      <td>-1.345392</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.543897</td>
      <td>0.108985</td>
      <td>-0.894673</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.119571</td>
      <td>0.277534</td>
      <td>0.565290</td>
    </tr>
    <tr>
      <td>3</td>
      <td>NaN</td>
      <td>-1.224501</td>
      <td>-0.263712</td>
    </tr>
    <tr>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.677172</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-1.826695</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.488499</td>
      <td>-0.146067</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.478887</td>
      <td>0.005307</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-1.381830</td>
      <td>-1.513847</td>
      <td>-0.294862</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.351416</td>
      <td>-1.788736</td>
      <td>1.099136</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A   -0.186593
B   -0.455035
C   -0.258769
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dff</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.475864</td>
      <td>0.641042</td>
      <td>-1.345392</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.543897</td>
      <td>0.108985</td>
      <td>-0.894673</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.119571</td>
      <td>0.277534</td>
      <td>0.565290</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-0.186593</td>
      <td>-1.224501</td>
      <td>-0.263712</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-0.186593</td>
      <td>-0.455035</td>
      <td>-0.677172</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-1.826695</td>
      <td>-0.455035</td>
      <td>-0.258769</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.488499</td>
      <td>-0.146067</td>
      <td>-0.258769</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.478887</td>
      <td>0.005307</td>
      <td>-0.258769</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-1.381830</td>
      <td>-1.513847</td>
      <td>-0.294862</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.351416</td>
      <td>-1.788736</td>
      <td>1.099136</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dff</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.475864</td>
      <td>0.641042</td>
      <td>-1.345392</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.543897</td>
      <td>0.108985</td>
      <td>-0.894673</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.119571</td>
      <td>0.277534</td>
      <td>0.565290</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-0.413640</td>
      <td>-1.224501</td>
      <td>-0.263712</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-0.413640</td>
      <td>-0.070380</td>
      <td>-0.677172</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-1.826695</td>
      <td>-0.070380</td>
      <td>-0.294862</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.488499</td>
      <td>-0.146067</td>
      <td>-0.294862</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.478887</td>
      <td>0.005307</td>
      <td>-0.294862</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-1.381830</td>
      <td>-1.513847</td>
      <td>-0.294862</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.351416</td>
      <td>-1.788736</td>
      <td>1.099136</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dff</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.475864</td>
      <td>0.641042</td>
      <td>-1.345392</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.543897</td>
      <td>0.108985</td>
      <td>-0.894673</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.119571</td>
      <td>0.277534</td>
      <td>0.565290</td>
    </tr>
    <tr>
      <td>3</td>
      <td>NaN</td>
      <td>-1.224501</td>
      <td>-0.263712</td>
    </tr>
    <tr>
      <td>4</td>
      <td>NaN</td>
      <td>-0.455035</td>
      <td>-0.677172</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-1.826695</td>
      <td>-0.455035</td>
      <td>-0.258769</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.488499</td>
      <td>-0.146067</td>
      <td>-0.258769</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.478887</td>
      <td>0.005307</td>
      <td>-0.258769</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-1.381830</td>
      <td>-1.513847</td>
      <td>-0.294862</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.351416</td>
      <td>-1.788736</td>
      <td>1.099136</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dados faltantes também podem ser preenchidos usando interpolação, por meio do método <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.interpolate.html#pandas.DataFrame.interpolate"><em>interpolate</em></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/3/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">ts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="n">ts2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">34</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">ts2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03   -0.212776
2000-01-04   -0.340666
2000-01-05         NaN
2000-01-06         NaN
2000-01-07   -0.922830
                ...   
2000-04-07         NaN
2000-04-08   -0.019257
2000-04-09         NaN
2000-04-10         NaN
2000-04-11    0.090057
Freq: D, Length: 100, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>66
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts2</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f6692111ac8&gt;
</pre></div>
</div>
<img alt="../_images/04_pand_269_1.png" src="../_images/04_pand_269_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts3</span> <span class="o">=</span> <span class="n">ts2</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>

<span class="n">ts3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-03   -0.212776
2000-01-04   -0.340666
2000-01-05   -0.534721
2000-01-06   -0.728775
2000-01-07   -0.922830
                ...   
2000-04-07    0.180670
2000-04-08   -0.019257
2000-04-09    0.017181
2000-04-10    0.053619
2000-04-11    0.090057
Freq: D, Length: 100, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts3</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts3</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f6691dce080&gt;
</pre></div>
</div>
<img alt="../_images/04_pand_272_1.png" src="../_images/04_pand_272_1.png" />
</div>
</div>
<p>O método interpolate pode levar em consideração os valores dos índices (caso eles não sejam regularmente intervalados):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">])</span>

<span class="n">ser</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0      0.0
1.0      NaN
10.0    10.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0      0.0
1.0      5.0
10.0    10.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;values&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0      0.0
1.0      1.0
10.0    10.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Também é possível interpolar <em>DataFrames</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">5.6</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">],</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">12.2</span><span class="p">,</span> <span class="mf">14.4</span><span class="p">]})</span>

<span class="n">dfi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.0</td>
      <td>0.25</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4.7</td>
      <td>4.00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5.6</td>
      <td>12.20</td>
    </tr>
    <tr>
      <td>5</td>
      <td>6.8</td>
      <td>14.40</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfi</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.0</td>
      <td>0.25</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.1</td>
      <td>1.50</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3.4</td>
      <td>2.75</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4.7</td>
      <td>4.00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5.6</td>
      <td>12.20</td>
    </tr>
    <tr>
      <td>5</td>
      <td>6.8</td>
      <td>14.40</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O argumento <em>method</em> flexibiliza <em>interpolate</em> para poder usar diferentes métodos de interpolação:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>

<span class="n">missing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">29</span><span class="p">])</span>

<span class="n">ser</span><span class="p">[</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic&#39;</span><span class="p">]</span>

<span class="n">dfi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">m</span><span class="p">:</span> <span class="n">ser</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">})</span>

<span class="n">dfi</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f6678a478d0&gt;
</pre></div>
</div>
<img alt="../_images/04_pand_281_1.png" src="../_images/04_pand_281_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="removendo-rotulos">
<h2><span class="section-number">3.3.10. </span>Removendo rótulos<a class="headerlink" href="#removendo-rotulos" title="Permalink to this headline">¶</a></h2>
<p>Caso a intenção ao usar <em>reindex</em> seja apenas remover certos rótulos, o ideal é usar o método <em>drop</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-2.087604</td>
      <td>0.639633</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.482247</td>
      <td>-0.864124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>  <span class="c1"># o mesmo resultado, mas usando reindex</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;one&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>0.639633</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>d</td>
      <td>-1.482247</td>
      <td>-0.864124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="renomeando-rotulos">
<h2><span class="section-number">3.3.11. </span>Renomeando rótulos<a class="headerlink" href="#renomeando-rotulos" title="Permalink to this headline">¶</a></h2>
<p>Para renomear índices e colunas, <em>pandas</em> fornece o método <em>rename()</em>, que pode receber como parâmetros um dicionário, uma <em>Series</em> ou uma função. Caso uma função seja usada, ela deve retornar um valor único e válido para cada rótulo renomeado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a   -1.395306
b    0.823696
c   -0.131460
d   -1.139574
e   -1.670965
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A   -1.395306
B    0.823696
C   -0.131460
D   -1.139574
E   -1.670965
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Ao renomear usando um mapeamento, os rótulos que não forem especificados não são renomeados. Além disso, se o mapeamento contiver rótulos inexistentes, eles são apenas ignorados sem erro.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-2.087604</td>
      <td>0.639633</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.482247</td>
      <td>-0.864124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">},</span>
    <span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;durian&#39;</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>apple</td>
      <td>-2.087604</td>
      <td>0.639633</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>banana</td>
      <td>-0.511575</td>
      <td>0.722227</td>
      <td>-0.804665</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-0.006408</td>
      <td>-0.086431</td>
      <td>1.220307</td>
    </tr>
    <tr>
      <td>durian</td>
      <td>NaN</td>
      <td>-1.482247</td>
      <td>-0.864124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="substituindo-valores">
<h2><span class="section-number">3.3.12. </span>Substituindo valores<a class="headerlink" href="#substituindo-valores" title="Permalink to this headline">¶</a></h2>
<p>Frequentemente é necessário substituir certos valores em uma <em>DataFrame</em> ou <em>Series</em>. O método <em>replace</em> é uma forma simples e eficiente de realizar essa operação. Em uma <em>Series</em>, é possível substituir um único valor ou uma lista de valores por outros valores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>

<span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    5.0
1    1.0
2    2.0
3    3.0
4    4.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    4.0
1    3.0
2    2.0
3    1.0
4    0.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Também é possível especificar um dicionário de substituições:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     10.0
1    100.0
2      2.0
3      3.0
4      4.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Para <em>DataFrames</em>, é possível determinar substituições por coluna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>

<span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <td>4</td>
      <td>4</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2</td>
      <td>100</td>
      <td>7</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <td>4</td>
      <td>4</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ao invés de substituir por valores específicos, é possível tratar todos os valores dados como faltantes e preencher ou interpolar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.0
1    1.0
2    2.0
3    3.0
4    4.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.0
1    1.0
2    1.0
3    1.0
4    4.0
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="aplicando-funcoes">
<h2><span class="section-number">3.3.13. </span>Aplicando funções<a class="headerlink" href="#aplicando-funcoes" title="Permalink to this headline">¶</a></h2>
<p>Funções arbitrárias podem ser aplicadas a um eixo de uma <em>DataFrame</em> usando o método <em>apply()</em>, que recebe um argumento opcional de eixo (<em>axis</em>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="p">})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-0.844214</td>
      <td>-0.313508</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>0.000010</td>
      <td>0.771012</td>
      <td>1.467678</td>
    </tr>
    <tr>
      <td>c</td>
      <td>0.542353</td>
      <td>-1.868091</td>
      <td>-0.335677</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>1.731185</td>
      <td>0.611341</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one     -0.100617
two      0.080149
three    0.581114
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># equivalente ao resultado acima</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one     -0.100617
two      0.080149
three    0.581114
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a   -0.578861
b    0.746233
c   -0.553805
d    1.171263
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># equivalente ao resultado acima</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a   -0.578861
b    0.746233
c   -0.553805
d    1.171263
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one      1.386566
two      3.599275
three    1.803355
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>0.429895</td>
      <td>0.730878</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>1.000010</td>
      <td>2.161952</td>
      <td>4.339148</td>
    </tr>
    <tr>
      <td>c</td>
      <td>1.720049</td>
      <td>0.154418</td>
      <td>0.714854</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>5.647340</td>
      <td>1.842901</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O tipo de retorno da função usada no <em>apply()</em> influencia o tipo da saída. Se a função aplicada retornar uma <em>Series</em>, o resultado será uma <em>DataFrame</em>, caso contrário, o resultado será uma <em>Series</em>. O método <em>apply</em> pode ser usado de formas criativas para responder perguntas sobre um conjunto de dados. Por exemplo: suponha que queiramos saber a data onde o valor mínimo ocorreu para cada coluna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tsdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span> 
                        <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="p">)</span>


<span class="n">tsdf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A   2000-10-26
B   2000-02-10
C   2001-02-25
dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<p>Também pode ser útil passar argumentos posicionais ou nomeados para o método <em>apply</em>. Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">subtract_and_divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">divide</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">sub</span><span class="p">)</span> <span class="o">/</span> <span class="n">divide</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">subtract_and_divide</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span> <span class="n">divide</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>a</td>
      <td>-1.948071</td>
      <td>-1.771169</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>b</td>
      <td>-1.666663</td>
      <td>-1.409663</td>
      <td>-1.177441</td>
    </tr>
    <tr>
      <td>c</td>
      <td>-1.485882</td>
      <td>-2.289364</td>
      <td>-1.778559</td>
    </tr>
    <tr>
      <td>d</td>
      <td>NaN</td>
      <td>-1.089605</td>
      <td>-1.462886</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Por último, <em>apply</em> pode receber o argumento <em>raw</em>, que é <em>False</em> por padrão. Caso ele seja passado como <em>True</em>, cada linha ou coluna é convertido para um objeto <em>array</em> de <em>NumPy</em> antes de realizar as operações o que pode trazer um impacto positivo de performance, caso as funcionalidades de indexação sejam desnecessárias.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./math"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="03_scip.html" title="previous page"><span class="section-number">3.2. </span>SciPy</a>
    <a class='right-next' id="next-link" href="05_matp.html" title="next page"><span class="section-number">3.4. </span>Matplotlib</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Telmo de Menezes e Silva Filho<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>